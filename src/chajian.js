

function J(a) {
  for (var s = 5; void 0 !== s;) {switch (s % 10) {
    case 0: !(function (J, e) { switch (s / 10 | 0) { case 0: return s = t < 64 ? 70 : 3; case 1: return s = t < o ? 6 : 90; case 2: return s = t < U ? 31 : 2; case 3: return i = -i, s = 51; case 4: return t += 4, s = 60; case 5: return b += a.charCodeAt(t), s = 1; case 6: return s = t < c.length ? 9 : 12; case 7: return f[r.charAt(t)] = t, s = 91; case 8: return s = 0 == i ? 41 : 51; case 9: t = 0, s = 60 } }()); break; case 1: !(function (J, e) { switch (s / 10 | 0) { case 0: return t++ , s = 11; case 1: return s = t < U ? 50 : 7; case 2: return t++ , s = 20; case 3: return i = 31 * i + ~t >>> 0, n[t] = i % U, s = 21; case 4: return i = 13, s = 51; case 5: return t = 0, s = 20; case 6: return t += 4, s = 10; case 7: return t++ , s = 81; case 8: return s = t < U ? 8 : 4; case 9: t++ , s = 0 } }()); break; case 2: !(function (J, e) { switch (s / 10 | 0) { case 0: return t = 0, s = 81; case 1: h = u.join("|"), s = void 0 } }()); break; case 3: var J = u.pop(); o = J.length, p = [], t = 0, s = 10; break; case 4: var c = (u = (a = u.join('')).split('|')).pop(),
      r = u.pop(),
      f = {}; s = t = 0; break; case 5: var t,
        o,
        u = a.split(''),
        U = u.length,
        n = [],
        b = 0; t = 0, s = 11; break; case 6: var e = f[J.charAt(t + 0)] << 18 | f[J.charAt(t + 1)] << 12 | f[J.charAt(t + 2)] << 6 | f[J.charAt(t + 3)]; p.push(e), s = 61; break; case 7: var i = ~(b * U); s = i < 0 ? 30 : 80; break; case 8: var l = n[t],
          v = u[l]; u[l] = u[0], u[0] = v, s = 71; break; case 9: e = f[c.charAt(t + 0)] << 18 | f[c.charAt(t + 1)] << 12 | f[c.charAt(t + 2)] << 6 | f[c.charAt(t + 3)]; k.push(e), s = 40
  }}
} function r(J, a) {
  function e(J) { return r[J] } function s(J, e) { r[J] = e } for (var c = 3; void 0 !== c;) {switch (c % 7) {
    case 0: !(function (J, e) { switch (c / 7 | 0) { case 0: return c = 35; case 1: return v = !1, c = l > p.length ? 2 : 6; case 2: return l += F + 1, c = 28; case 3: return c = void 0 === l ? 1 : 15; case 4: return c = 7; case 5: c = void 0; break; case 6: f = k[a], t = [], o = [void 0], u = [], c = 8 } }()); break; case 1: !(function (J, e) { switch (c / 7 | 0) { case 0: return c = 35; case 1: return c = 5; case 2: return c = !1 === v ? 14 : 28; case 3: return r = h.split("\t"), U = 0, c = 29; case 4: return c = U < r.length ? 4 : 42; case 5: U++ , c = 29 } }()); break; case 2: return; case 3: var r,
      f,
      t,
      o,
      u,
      U,
      n,
      b,
      i; c = 22; break; case 4: try { r[U] = J(r[U]) } catch (J) { r[U] = void 0 } c = 36; break; case 5: var l,
        v,
        D,
        L,
        d = 0,
        g = 0,
        M = [],
        X = !0; L = [void 0], l = f - 1, D = 0, c = 7; break; case 6: var T,
          G,
          j,
          m,
          q,
          _,
          y,
          A,
          w,
          V,
          F = 0; switch (511 & (T = p[l])) { case 25: case 153: case 281: case 409: m = T >> 7 & 4095, m |= (T >> 20 & 1) << 12, m |= (T >> 19 & 1) << 13, m = (m |= (T >> 21 & 3) << 14) << 16 >> 16, L.push(l + m); break; case 0: case 8: case 16: case 24: case 32: case 40: case 48: case 56: case 64: case 72: case 80: case 88: case 96: case 104: case 112: case 120: case 128: case 136: case 144: case 152: case 160: case 168: case 176: case 184: case 192: case 200: case 208: case 216: case 224: case 232: case 240: case 248: case 256: case 264: case 272: case 280: case 288: case 296: case 304: case 312: case 320: case 328: case 336: case 344: case 352: case 360: case 368: case 376: case 384: case 392: case 400: case 408: case 416: case 424: case 432: case 440: case 448: case 456: case 464: case 472: case 480: case 488: case 496: case 504: (736 & T) == 96 ? (m = T >> 8 & (F = 1), m |= (T >> 10 & 7) << 1, q = (G = p[l + 1]) >> 22 & 1, q |= (T >> 19 & 3) << 1, q |= (T >> 22 & 3) << 3, _ = 1 & G, _ |= (G >> 16 & 1) << 1, _ |= (G >> 2 & 1) << 2, _ |= (G >> 6 & 1) << 3, _ |= (G >> 8 & 1) << 4, y = G >> 9 & 3, y |= (G >> 14 & 3) << 2, y |= (G >> 17 & 1) << 4, t[m |= (T >> 18 & 1) << 4] = o.pop(), u.push(t[m]), t[q] = o.pop(), u.push(t[q]), t[_] = o.pop(), u.push(t[_]), t[y] = o.pop(), u.push(t[y])) : (324664 & T) == 8208 ? (m = T >> 6 & 7, m |= (T >> 11 & (F = 1)) << 3, q = T >> 19 & 7, q |= (T >> 23 & 1) << 3, q |= (1 & (G = p[l + 1])) << 4, q |= (G >> 2 & 2047) << 5, t[m |= (T >> 16 & 1) << 4] = q) : (544 & T) == 544 ? (m = T >> 3 & 3, q = T >> 10 & 3, q |= (T >> 13 & 127) << (F = 2), q |= (T >> 21 & 7) << 9, q |= ((G = p[l + 1]) >> 1 & 1) << 12, q |= (G >> 3 & 1) << 13, q |= (G >> 5 & 1) << 14, q |= (G >> 9 & 1) << 15, _ = G >> 11 & 1, _ |= (G >> 13 & 3) << 1, _ |= ((j = p[l + 2]) >> 12 & 1) << 3, _ |= (G >> 20 & 1) << 4, _ |= (G >> 15 & 31) << 5, _ |= (G >> 21 & 7) << 10, _ |= (j >> 0 & 7) << 13, t[m |= (T >> 6 & 7) << 2] = e(q + _)) : (736 & T) == 32 ? (m = T >> 3 & (F = 1), m |= (T >> 10 & 1) << 1, m |= (T >> 15 & 3) << 2, q = T >> 17 & 7, q |= (T >> 21 & 3) << 3, _ = T >> 23 & 1, _ |= ((G = p[l + 1]) >> 0 & 32767) << 1, t[m |= (T >> 20 & 1) << 4] = e(t[q] + _)) : (42040 & T) == 40976 ? (m = (G = p[l + (F = 1)]) >> 22 & 1, m |= (T >> 6 & 1) << 1, m |= (T >> 9 & 1) << 2, m |= (T >> 14 & 1) << 3, q = T >> 18 & 31, q |= (1 & G) << 5, q = (q |= (G >> 2 & 1023) << 6) << 16 >> 16, t[m |= (T >> 17 & 1) << 4] = q) : (672 & T) == 160 ? (m = T >> 3 & 3, m |= (T >> 8 & (F = 1)) << 2, q = T >> 17 & 3, q |= (T >> 20 & 1) << 2, q |= (T >> 23 & 1) << 3, q |= ((G = p[l + 1]) >> 1 & 1) << 4, q |= (G >> 3 & 2047) << 5, _ = G >> 14 & 31, t[m |= (T >> 13 & 3) << 3] = e(q + t[_])) : (308280 & T) == 270352 ? (m = T >> 6 & 15, q = T >> 14 & (F = 1), q |= (T >> 16 & 3) << 1, q |= (T >> 20 & 1) << 3, q |= (T >> 22 & 1) << 4, q |= (1 & (G = p[l + 1])) << 5, q |= (G >> 5 & 1) << 6, q |= (G >> 7 & 511) << 7, t[m |= (T >> 11 & 1) << 4] = q) : (324664 & T) == 24592 ? (v = !0, L.pop(), void 0 === (l = o.pop()) && (l = -1)) : (m = T >> 6 & 15, q = T >> 14 & (F = 1), q |= (T >> 16 & 1) << 1, q |= (T >> 21 & 7) << 2, _ = 3 & (G = p[l + 1]), _ |= (G >> 4 & 7) << 2, t[m |= (T >> 11 & 1) << 4] = e(t[q] + t[_])); break; case 63: case 191: case 319: case 447: q = T >> 12 & 31, t[m = T >> 7 & 31] = !t[q]; break; case 95: case 223: case 351: case 479: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] >>> t[_]; break; case 31: case 159: case 287: case 415: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] << t[_]; break; case 111: case 239: case 367: case 495: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] > t[_]; break; case 79: case 207: case 335: case 463: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] < t[_]; break; case 143: case 175: case 399: case 431: m = T >> 5 & 1, q = T >> 12 & 31, _ = T >> 17 & 31, t[m |= (T >> 8 & 15) << 1] = t[q] && t[_]; break; case 119: case 247: case 375: case 503: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] % t[_]; break; case 55: case 183: case 311: case 439: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] / t[_]; break; case 15: case 47: case 271: case 303: m = T >> 5 & 1, q = T >> 12 & 31, _ = T >> 17 & 31, t[m |= (T >> 8 & 15) << 1] = t[q] || t[_]; break; case 87: case 215: case 343: case 471: if (q = T >> 12 & 63, q |= ((G = p[l + (F = 1)]) >> 11 & 1) << 6, q |= (T >> 18 & 63) << 7, q |= (G >> 0 & 7) << 13, _ = G >> 3 & 255, 'number' === typeof t[m = T >> 7 & 31].jsvmfunc) { for (U = 1; U <= _; U++)M.push(e(q + U)); X = !0, o.push(e(q)), v = !0, o.push(l + 1 + F), l = t[m].jsvmfunc - 1, L.push(-1), g = d = 0 } else { for (n = [], b = e(q), U = 0; U < _; U++)n.push(e(q + _ - U)); o.push(t[m].apply(b, n)) } break; case 103: case 231: case 359: case 487: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] & t[_]; break; case 39: case 167: case 295: case 423: q = T >> 12 & 31, t[m = T >> 7 & 31] = ~t[q]; break; case 23: case 151: case 279: case 407: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] * t[_]; break; case 7: case 71: case 263: case 327: m = T >> 6 & 1, q = T >> 12 & 31, _ = T >> 17 & 31, t[m |= (T >> 8 & 15) << 1] = t[q] | t[_]; break; case 125: case 253: case 381: case 509: if (m = (m = T >> 7 & 65535) << 16 >> 16, q = T >> 23 & (F = 1), q |= ((G = p[l + 1]) >> 0 & 15) << 1, o.length <= m) break; o[o.length - 1 - m] = t[q]; break; case 93: case 221: case 349: case 477: if (m = T >> 7 & 31, q = T >> 12 & 4095, q = (q |= ((G = p[l + (F = 1)]) >> 0 & 15) << 12) << 16 >> 16, o.length <= q) break; t[m] = o[o.length - 1 - q]; break; case 135: case 199: case 391: case 455: m = T >> 6 & 1, q = T >> 12 & 31, _ = T >> 17 & 31, t[m |= (T >> 8 & 15) << 1] = t[q] ^ t[_]; break; case 157: case 189: case 413: case 445: if (m = T >> 5 & 1, m |= (T >> 8 & 15) << 1, q = T >> 12 & 31, o.length <= t[m]) break; o[o.length - 1 - t[m]] = t[q]; break; case 29: case 61: case 285: case 317: m = T >> 5 & 1, q = T >> 12 & 255, t[m |= (T >> 8 & 15) << 1] = q == 0 ? {} : q == 1 ? [] : void 0; break; case 205: case 237: case 461: case 493: for (m = T >> 5 & 1, m |= (T >> 8 & 127) << 1, U = 0; U < m; U++)o.push(u.pop()); break; case 77: case 109: case 333: case 365: for (m = T >> 5 & (F = 1), m |= (T >> 8 & 32767) << 1, q = T >> 23 & 1, q |= ((G = p[l + 1]) >> 0 & 32767) << 1, U = 1; U <= q; U++)s(m + q - U, o.pop()); break; case 13: case 141: case 269: case 397: q = T >> 12 & 31, t[m = T >> 7 & 31] = o.pop(), u.push(t[m]), t[q] = o.pop(), u.push(t[q]); break; case 45: case 173: case 301: case 429: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = o.pop(), u.push(t[m]), t[q] = o.pop(), u.push(t[q]), t[_] = o.pop(), u.push(t[_]); break; case 85: case 117: case 341: case 373: if (m = T >> 5 & 1, q = T >> 12 & 15, q |= (T >> 23 & 1) << 4, _ = T >> 16 & 31, void 0 === t[m |= (T >> 8 & 15) << 1]) jsvm_this_tmpValue = t[_], finalHash = jsvm_this_tmpValue, J(`${t[q]} = jsvm_this_tmpValue;`); else try { t[m][t[q]] = t[_] } catch (J) { if (v = !0, (l = L.pop()) == null) break; l === -1 && (l = L.pop()), d === 2 && (d = L.pop(), (l = L.pop()) === -1 && (o.pop(), l = L.pop())), g = 3 + d, d = (d + 1) % 3, t[0] = J } break; case 213: case 245: case 469: case 501: m = T >> 5 & 1, m |= (T >> 8 & 15) << 1, q = T >> 12 & 31, _ = T >> 17 & 31; try { t[m] = t[q][t[_]] } catch (J) { if (v = !0, (l = L.pop()) == null) break; l === -1 && (l = L.pop()), d === 2 && (d = L.pop(), (l = L.pop()) === -1 && (o.pop(), l = L.pop())), g = 3 + d, d = (d + 1) % 3, t[0] = J } break; case 149: case 181: case 405: case 437: m = T >> 5 & (F = 1), q = T >> 12 & 31, _ = T >> 17 & 127, _ |= ((G = p[l + 1]) >> 0 & 31) << 7, t[m |= (T >> 8 & 15) << 1] = t[q][_]; break; case 21: case 53: case 277: case 309: m = T >> 5 & (F = 1), q = T >> 12 & 4095, _ = (G = p[l + 1]) >> 0 & 31, t[m |= (T >> 8 & 15) << 1][q] = t[_]; break; case 37: case 101: case 293: case 357: if (m = T >> 6 & 1, m |= (T >> 8 & 127) << 1, X) for (U = 0; U < m; U++)o.push(M.pop()); X = !(M = []); break; case 69: case 197: case 325: case 453: m = T >> 7 & 31, jsvm_this_tmpValue = t[q = T >> 12 & 31], finalHash = jsvm_this_tmpValue, J(`${t[m]} = jsvm_this_tmpValue;`); break; case 5: case 133: case 261: case 389: q = T >> 12 & 31, t[m = T >> 7 & 31] = J('' + t[q]); break; case 441: case 443: case 505: case 507: m = T >> 1 & 1, m |= (T >> 6 & 1) << 1, m |= (T >> 9 & 7) << 2, t[0] = t[m], g = 3 + d; break; case 165: case 229: case 421: case 485: m = T >> 6 & 1, t[m |= (T >> 8 & 15) << 1] = {}; break; case 185: case 187: case 249: case 251: v = !0, l = L.pop(), d = L.pop(), g > 3 && ((l = L.pop()) === -1 && (o.pop(), l = L.pop())), g = 0; break; case 57: case 59: case 313: case 315: m = T >> 1 & 1, m |= (T >> 8 & 4095) << 1, m |= (T >> 21 & 1) << 13, m |= (T >> 20 & 1) << 14, v = !0, l = (m |= (T >> 22 & 1) << 15) - 1; break; case 217: case 219: case 473: case 475: v = !0, l = L.pop(), d++ , g === 0 && (l = L.pop(), d++); break; case 89: case 91: case 345: case 347: v = !0, l = L.pop(), d++; break; case 121: case 123: case 377: case 379: m = T >> (F = 1) & 1, q = T >> 12 & 4095, q |= ((G = p[l + 1]) >> 0 & 15) << 12, t[m |= (T >> 8 & 15) << 1] && (v = !0, l = q - 1); break; case 27: case 155: case 283: case 411: m = (m = T >> 7 & 65535) << 16 >> 16, L.push(d), d = g = 0, L.push(l + m); break; case 107: case 235: case 363: case 491: q = T >> 12 & 31, t[m = T >> 7 & 31] && (v = !0, l = t[q] - 1); break; case 127: case 255: case 383: case 511: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] >> t[_]; break; case 43: case 171: case 299: case 427: for (m = T >> 7 & 65535, q = T >> 23 & (F = 1), q |= ((G = p[l + 1]) >> 0 & 32767) << 1, U = 0; U < q; U++)o.push(e(m + U)); break; case 75: case 203: case 331: case 459: m = T >> 7 & 31, o.push(t[m]); break; case 11: case 139: case 267: case 395: q = T >> 12 & 31, t[m = T >> 7 & 31] = t[q]; break; case 201: case 233: case 457: case 489: m = T >> 5 & 1, m |= (T >> 8 & 15) << 1, q = T >> 12 & 31, o.push(t[m]), o.push(t[q]); break; case 73: case 105: case 329: case 361: m = T >> 5 & 1, m |= (T >> 8 & 15) << 1, q = T >> 12 & 31, _ = T >> 17 & 31, o.push(t[m]), o.push(t[q]), o.push(t[_]); break; case 137: case 169: case 393: case 425: m = T >> 5 & (F = 1), m |= (T >> 8 & 15) << 1, q = T >> 12 & 31, _ = T >> 17 & 31, y = T >> 22 & 3, y |= ((G = p[l + 1]) >> 0 & 7) << 2, o.push(t[m]), o.push(t[q]), o.push(t[_]), o.push(t[y]); break; case 9: case 41: case 265: case 297: m = T >> 5 & 1, t[m |= (T >> 8 & 15) << 1] = o.pop(), u.push(t[m]); break; case 115: case 243: case 371: case 499: m = T >> 7 & 31, X = !(v = !0), o.push(l + 1 + F), l = t[m] - 1, L.push(-1), g = d = 0; break; case 177: case 241: case 433: case 497: m = T >> 6 & 1, v = !0, l = t[m |= (T >> 8 & 15) << 1] - 1; break; case 51: case 179: case 307: case 435: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] + t[_]; break; case 49: case 113: case 305: case 369: m = T >> 6 & 1, q = T >> 12 & 31, _ = T >> 17 & 31, t[m |= (T >> 8 & 15) << 1] = t[q] - t[_]; break; case 35: case 163: case 291: case 419: m = T >> 7 & 31, q = T >> 12 & 31, _ = T >> 17 & 31; try { t[m] = q === 31 ? t[_]() : t[q][t[_]]() } catch (J) { if (v = !0, (l = L.pop()) == null) break; l === -1 && (l = L.pop()), d === 2 && (d = L.pop(), (l = L.pop()) === -1 && (o.pop(), l = L.pop())), g = 3 + d, d = (d + 1) % 3, t[0] = J } break; case 97: case 225: case 353: case 481: m = T >> 7 & 31, q = T >> 12 & 31, _ = T >> 17 & 31, y = T >> 22 & 3, y |= ((G = p[l + (F = 1)]) >> 0 & 7) << 2; try { t[m] = q === 31 ? t[_](t[y]) : t[q][t[_]](t[y]) } catch (J) { if (v = !0, (l = L.pop()) == null) break; l === -1 && (l = L.pop()), d === 2 && (d = L.pop(), (l = L.pop()) === -1 && (o.pop(), l = L.pop())), g = 3 + d, d = (d + 1) % 3, t[0] = J } break; case 99: case 227: case 355: case 483: q = T >> 12 & 31, _ = T >> 17 & 31, s(t[m = T >> 7 & 31] + t[_], t[q]); break; case 147: case 211: case 403: case 467: m = T >> 6 & 1, q = T >> 12 & 31, t[m |= (T >> 8 & 15) << 1] = J(t[q]); break; case 33: case 161: case 289: case 417: m = T >> 7 & 31, q = T >> 12 & 31, _ = T >> 17 & 31, y = T >> 22 & 3, y |= ((G = p[l + (F = 1)]) >> 0 & 7) << 2, A = G >> 3 & 3, A |= (G >> 14 & 1) << 2, A |= (G >> 5 & 3) << 3; try { t[m] = q === 31 ? t[_](t[y], t[A]) : t[q][t[_]](t[y], t[A]) } catch (J) { if (v = !0, (l = L.pop()) == null) break; l === -1 && (l = L.pop()), d === 2 && (d = L.pop(), (l = L.pop()) === -1 && (o.pop(), l = L.pop())), g = 3 + d, d = (d + 1) % 3, t[0] = J } break; case 81: case 209: case 337: case 465: m = T >> 17 & 1, m |= (T >> 7 & 15) << 1, q = T >> 11 & 31, _ = T >> 16 & 1, _ |= (T >> 18 & 15) << 1, D += 3, o.push(t[m]), o.push(t[q]), o.push(t[_]); break; case 19: case 83: case 275: case 339: m = T >> 6 & 1, m = (m |= (T >> 8 & 32767) << 1) << 16 >> 16, L.push(l + m); break; case 67: case 195: case 323: case 451: m = T >> 7 & 31, q = T >> 12 & 15, q |= (T >> 18 & (F = 1)) << 4, _ = T >> 16 & 3, _ |= (T >> 19 & 7) << 2, y = T >> 22 & 3, y |= ((G = p[l + 1]) >> 0 & 7) << 2, A = G >> 3 & 31, w = G >> 8 & 31, V = G >> 13 & 31; try { if (D === 0) t[m] = q === 31 ? t[_](t[y], t[A], t[w], t[V]) : t[q][t[_]](t[y], t[A], t[w], t[V]); else { for (n = [], b = q == 31 ? void 0 : t[q], n.push(t[y]), n.push(t[A]), n.push(t[w]), n.push(t[V]), i = [], U = 0; U < D; U++)i.push(o.pop()); for (U = 0; U < D; U++)n.push(i.pop()); t[m] = q == 31 ? t[_].apply(b, n) : b[t[_]](...n), D = 0 } } catch (J) { if (v = !0, (l = L.pop()) == null) break; l === -1 && (l = L.pop()), d === 2 && (d = L.pop(), (l = L.pop()) === -1 && (o.pop(), l = L.pop())), g = 3 + d, d = (d + 1) % 3, t[0] = J } break; case 17: case 145: case 273: case 401: m = T >> 7 & 15, m |= ((G = p[l + (F = 1)]) >> 12 & 1) << 4, q = T >> 11 & 31, _ = T >> 16 & 31, y = T >> 21 & 7, y |= (G >> 0 & 3) << 3, D += 4, o.push(t[m]), o.push(t[q]), o.push(t[_]), o.push(t[y]); break; case 129: case 131: case 385: case 387: m = T >> 1 & 1, m |= (T >> 8 & 15) << 1, q = T >> 12 & 31, D += 2, o.push(t[m]), o.push(t[q]); break; case 65: case 193: case 321: case 449: m = T >> 7 & 31, q = T >> 12 & 31, _ = T >> 17 & 31, y = T >> 22 & 3, y |= ((G = p[l + (F = 1)]) >> 0 & 7) << 2, A = G >> 3 & 31, w = G >> 8 & 31; try { t[m] = q === 31 ? t[_](t[y], t[A], t[w]) : t[q][t[_]](t[y], t[A], t[w]) } catch (J) { if (v = !0, (l = L.pop()) == null) break; l === -1 && (l = L.pop()), d === 2 && (d = L.pop(), (l = L.pop()) === -1 && (o.pop(), l = L.pop())), g = 3 + d, d = (d + 1) % 3, t[0] = J } break; case 186: case 250: case 442: case 506: m = T >> 6 & 1, t[m |= (T >> 8 & 15) << 1] = {}; break; case 58: case 122: case 314: case 378: m = T >> 6 & (F = 1), q = T >> 23 & 1, q |= ((G = p[l + 1]) >> 0 & 15) << 1, s((m |= (T >> 8 & 32767) << 1) + t[_ = G >> 4 & 31], t[q]); break; case 1: case 3: case 257: case 259: m = T >> 1 & 1, m |= (T >> 8 & 15) << 1, D += 1, o.push(t[m]); break; case 90: case 218: case 346: case 474: m = T >> 7 & 511, m |= ((G = p[l + (F = 1)]) >> 14 & 1) << 9, q = T >> 22 & 3, _ = G >> 3 & 2047, s((m |= (T >> 16 & 63) << 10) + (_ |= (G >> 15 & 31) << 11), t[q |= (G >> 0 & 7) << 2]); break; case 26: case 154: case 282: case 410: q = T >> 12 & 31, _ = T >> 17 & 127, _ |= ((G = p[l + (F = 1)]) >> 0 & 511) << 7, s(t[m = T >> 7 & 31] + _, t[q]); break; case 10: case 42: case 74: case 106: case 138: case 170: case 202: case 234: case 266: case 298: case 330: case 362: case 394: case 426: case 458: case 490: if (m = T >> 7 & 31, q = T >> 12 & 31, o.length <= t[q]) break; t[m] = o[o.length - 1 - t[q]]; break; case 50: case 114: case 306: case 370: m = T >> 6 & 1, t[m |= (T >> 8 & 15) << 1] = []; break; case 178: case 242: case 434: case 498: m = T >> 6 & 1, q = T >> 12 & 31, _ = T >> 17 & 31, t[m |= (T >> 8 & 15) << 1] = t[q] in t[_]; break; case 146: case 210: case 402: case 466: m = T >> 6 & 1, m |= (T >> 19 & 1) << 1, q = T >> 11 & 31, _ = T >> 16 & 7, _ |= (T >> 20 & 3) << 3, t[m |= (T >> 8 & 7) << 2] = t[q] !== t[_]; break; case 18: case 82: case 274: case 338: m = T >> 6 & 1, q = T >> 12 & 31, _ = T >> 17 & 31, t[m |= (T >> 8 & 15) << 1] = t[q] === t[_]; break; case 34: case 162: case 290: case 418: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] != t[_]; break; case 66: case 194: case 322: case 450: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] <= t[_]; break; case 98: case 226: case 354: case 482: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] == t[_]; break; default: q = T >> 12 & 31, _ = T >> 17 & 31, t[m = T >> 7 & 31] = t[q] >= t[_] }c = l === -1 ? 0 : 21
  }}
} var jsvm_this_tmpValue,
  p = [],
  h = [],
  k = [],
  f; function getBPENV(J) { J({ data: { hash: globalData.hash.hash, pin: globalData.hash.pin } }) } J("6JdUUnn0d+undffJneiJ6UdU8i+J/\tJf'\t8aJF'lJdUJJX''sJ1oGiJ'\tJJJaJJg8JUJdJ'JeJg8JJJundeUi6ed8'/'8's'Ual6JJ6f8'p8JD7J/tk\tMs'XUDut'/JJ'4J+'qJJm+rJuiJc\tJJJtJJJ+JJsJJJo'8ngJ'8U6TJU'\t88oSTr\tJJf\t'JM7j6JJJenfr'indeci1eJLunfJ6ined64/ff\ttrJe8Jkfk+XaUur '8JtUiJ'\tJjsJ6UuJJiJ8new OJJf|'(TmMhJJe+inJJsJpr/5JJ8JJJJJJNJJo4dJJ+J/Jjf8JJ8JTJJJJqJaJDD8JJ\tJJ4kMUUOJJ6JrpJJJeJUJJJJJGc'OonT6JJNfdrG6UJ8'JJJJp+\tTJJMJno+UpJX/G8JJ8Jo'GUrJJJJ6J1ufJrJnJ\t8 48J6L+JfLJXsJJAsJU968JqlJXJJfsrLiJJYJkcJqflJJ6\t8Jk8JJDJJ8J8\tLDJ6okJ66JqJ8MJJJJUJJDa'os8JJJt8JoU1JhDfsLMGJ6+JrfXfU8UJ6sUfL+XJts8LJJJTo48LoGflLJxJf)82J8JJ8rJf8D1J\tLUJJoJUJJ8rJ8KJl68vJJ/MJf8JGJJJJJJ8JJ+JULgJJ8J8L4/6JkavJJ'LJUU6Jf6JkrgJD4JJJDfcJ6Mof6+JJD/U5Jd\t8fJ8JJJlJ'MJ\tJ6J8\t6X'J88JfcJJtgRJfJf64lDJXJJJfJJDfJJJJJJK6UJ11UfFJrJos8JJJJhfJUJqJDfJ866JJ8JkJJ88JoJe6J6JDrJJ2MoLEdJJJGfLJJJbJ8JJMJJcJ8pJJUJUJr+JJKUT8dJJfff6+JJU18'J/f'\tf8JL+6JJs89fJJJ8hfJ'JfJ6JUULfJJJsGJ6JsJJJrJfUUJU6U1JJoJJJUJ6L1XfJUJ8oJJfJUJL+8JosJJJd+Jn\t'fJ6U6Ua6J8J8e+XUJJDrJJJJJJJ+tJ8rTDJDJJffJJDJJfJ+JJq+6oIMkUrf/J4s8eJ+JJUkeJf/JJG'Jt1lJJU8JtJfJfrJJJJ+JUfJffJUJL6fJeJJJJ1J+o48JoGUJJ+6J'JJJJJJ\tgJJJLJ1J688JJ'JJJ6UJJ6Uf/J+sfJaJfUJJJDUUMfTTJ68JJ1Jg/UeJo6MJJT++nDJ/GJfUfqD+JTMJJJ8X61JJJJUJJUkJ+JJsJf+st1lJgk'leJsJJ8Jf+JUJJJnJJJUfL88JJkJJ8cJJ64+JoGU\tJDdbGvJJ8JUkLJJJJL8JJ8'JkoUUJ66J1J8JJJ1JfkUpJJSJJJ/'U8UJJ6JJJDJJlfLMJJJJJ6rJprXJJk\tJJJJ6XJk1JfcXF4MLJ6JJJJkJJJJ8JJ+6J1JJ\tkUJJJJJJJU/JJ+fJJf8J9+J/f+Jt8UfLJJMdk8rJJJJ868J+62JGJJJfJJJ/olJJ6JkJJU/J rGJk+rJ'+JJDrJpGJ'fkJ\tk'IJJJ8JJJUXJJiJkJJJsfkJJJop\ta+JU1lJ+kfJrJJJk8LJJJGJJoJJJJJ3/frJJ8J8sJ1J1fU8nTMfu+oJ\tJ8foJJJo48JoJUJL\t1l++lGJJJJJJJJJfqLLdJyDJfkJ+UJfJJ+J54JG\t+JuJrJ48J+nJDJhGTfp1lgjJ8JkJJJJqJJJo6JP6kkJ8FTUJMJJJUJJJUJb8OJJJJJ6e68Jh'JJfJJUfUJfJJMJJXJeJ8U9p8Jof1tJo8JJ18+8lJ78J8J/\t8JJJUJJq1JJnUJJLg6/DUJUoUJJ81U'J/Jfk8JJJJJfJpJJDrfJJJXJ8'6lDoJJJJJJC+/JJJoJ/+U6JXJJk\tJJJUJ+4JJT+68Js8'JJf/JJ\tJJ86+q+Xqok8JJdJ+U'MJRJ+XJ/JJJfJJJr1JJJ1JJf+6nlJJJkJnJ6JJ8Jp6JTMJoJJJJoUJJJc66fJJfJffJcXDJstJJJfJo4o/kqJ'JmJJJUfc'T+'JJUJfJTJ+cX+oo/JJJJRJ\t8JJqff+J1JJJfJftJJrg8ffBfJL'J/JJJo8J8JML8JJJJJUJ+h4fJJJtUf6JXJos8JJJJNo4JrscsJJkJJJJJJ'J8f6J1voJ8kJJJrlo4JJUrJJFJJhm/JJkJJJfJJ\tFrTJUnJJf\tJJJJJ8JJ+JGxJJLkMJJ8JUJJfTDJJJqfBJqeuMJMUuJcfX+XJJDHJJJJ8J4JfJJJJJskJJJ/JJLMJJjUX+Jb6J6JJJJJ6JJJDJJJf8Dl+fk8oJ/JJJJJTJt'rJs8J/JJJXfTJJJUJJJ+JJJ+FJJUJJJT8/JSJfJUJJJ+JJCUJMJJJ8JjlJ8TJJ6skJfUJJpJ6JUXJJ+nJjsJJoJUUJckJJkJJJJnJJfJ+ofUog+TJJJD8ufjJ68eJoJ8'DJJkJf8sfcJ\tfJ8JLJJdUJJf88sJUsUc'JJJ8oJJk8UJJFUJJJ/JJs8J6+'JJoUJDJ\ttkLgJ8fUJoJkJJoUJJkJ8J8J1JU8JDJJJu+l'DJJJp+JUJ8oU8fJJfJJJJI8JfJEJ88fJDJfJJJrJeUUJJUU8klf|J6+Fj6JLTJJUMJrJJnJ/JJ4oJ8M1wQi8/Juz3JWx1tNJA8oJrefjZMGcJcVdJvJM|JfJ6"); var finalHash = ''; function getHash(e) { let t = ''; return getBPENV((a) => { let i, 
o, 
n, 
v, 
s, 
c, 
l, 
d, 
u; r((arg) => { var b = eval(arg); return eval(arg) }, 0) }), t }
'use strict'; var api = 'https://api.doushudata.com/?service=',
  getDestTimeUrl = `${api}App.Site.Datetime`,
  postCarDataUpUrl = `${api}App.Yishu_Data.CarDataUp`,
  postCarDataUpUrlVer = `${api}App.Yishu_Data.CarDataUpVer`,
  postItemsEffectDetailUpUrl = `${api}App.Yishu_Data.ItemsEffectDetailUp`,
  postItemsEffectDetailUpVer = `${api}App.Yishu_Data.ItemsEffectDetailUpVer`,
  postItemKeywordsUpUrl = `${api}App.Yishu_Data.ItemKeywordsUp`,
  postItemKeywordsUpVer = `${api}App.Yishu_Data.ItemKeywordsUpVer`,
  postListFlowFromUpUrl = `${api}App.Yishu_Data.ListFlowFromUp`,
  postListFlowFromUpVer = `${api}App.Yishu_Data.ListFlowFromUpVer`,
  postDataVerUrl = `${api}App.Yishu_Data.DataVer`,
  postItemVer = `${api}App.Yishu_Data.ItemVer`,
  postCreativeUpUrl = `${api}App.Yishu_Data.CreativeUp`,
  wsUrl = 'ws://ws.doushudata.com:7272/',
  nowTime = Date.now(),
  testZtcLogin = 'https://zhitongche.taobao.com/entry/isLogin.json',
  subWayReferer = '/report/bpreport/index?tcId=1&tabId=4&start={start}&end={end}&subFilterId=4',
  subWayUrl = 'https://subway.simba.taobao.com/report/rptBpp4pBidwordList.htm?startDate={startDate}&endDate={endDate}&sub=network&offset={offset}&pageSize={pageSize}&effect=1',
  getItemFromToTpl = `https://sycm.taobao.com/bda/itemformto/listFlowFromTo.json?algorithm=0&currentPage=1&dateRange={startDate}%7C{endDate}&dateType=day&device={device}&itemId={itemId}&pageSize=10&token={token}&_=${  nowTime}`,
  getItemKeywordTpl = `https://sycm.taobao.com/bda/items/itemanaly/itemformto/findItemKeywords.json?currentPage={currentPage}&dateRange={startDate}%7C{endDate}&dateType=day&device={device}&itemId={itemId}&order=uv&orderType=desc&search=&searchType=taobao&token={token}&pageSize={pageSize}&_=${  nowTime}`,
  getItemsEffectTpl = `https://sycm.taobao.com/bda/items/effect/getItemsEffectDetail.json?dateRange={startDate}%7C{endDate}&dateType=recent30&device={device}&orderDirection=false&orderField=itemUv&page={page}&pageLimit={pageLimit}&token={token}&type=1&_=${  nowTime}`,
  getCountSubway = 'https://subway.simba.taobao.com/report/commondCountSubQuery.htm?startDate={startDate}&endDate={endDate}&sub=network&offset=0&pageSize={pageSize}&effect=1',
  globalData = { flag: !0, time: 500, num: 10, min: 500, max: 1e3, subwayTokenData: {}, subwayToken: '', sycmToken: '', items: [], allDays: [], before30Day: '', token: '', dataIsOk: !1, runAsUserId: 0, hash: { hash: '', pin: '' } }
'use strict'; function addZero(e) { return e < 10 & e >= 0 ? `0${  e}` : e } function getBetweenRound(e, t) { return Math.floor(e + Math.random() * (t - e)) } function delayTime(e) { let t = new $.Deferred(); return setTimeout(() => { t.resolve() }, e), t } function dataSlice(e) { for (var t = Math.ceil(e.length / globalData.num), n = [], a = 0; a < t; a++)n.push(e.slice(a * globalData.num, (a + 1) * globalData.num)); return n }
'use strict'; let webSocketData = { subwayDays: [], itemsDays: [] },
  webSocket = new WebSocket(wsUrl); function sokcet() {
  webSocket.onopen = function () { console.log('webSocket open'); let a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle ? globalData.subwayTokenData.runAsShopTitle : null, runAsShopId: globalData.subwayTokenData.runAsShopId ? globalData.subwayTokenData.runAsShopId : null, token: globalData.token }; console.log(a), webSocket.send(JSON.stringify(a)) }, webSocket.onclose = function () { console.log('webSocket close'), setTimeout(() => { window.webSocket = new WebSocket(wsUrl), sokcet(); let a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token }; console.log(a), webSocket.send(JSON.stringify(a)) }, 3e3) }, webSocket.onmessage = function (a) {
    let n,
      t,
      p = JSON.parse(a.data); if (console.log(p), p.type == 'msg') chrome.notifications.create(null, { type: 'basic', iconUrl: 'images/logo48x48.png', title: p.head, message: p.content }); else if (p.shopId == globalData.subwayTokenData.runAsShopId) {if ('getInit' == p.type) {
      var e = (new Date()).getTime(),
      o = new Date(e - 864e5 - 324e5); itemsEffect.endDate = `${o.getFullYear()}-${addZero(o.getMonth() + 1)}-${addZero(o.getDate())}`; var r = new Date(e - 2592e6 - 324e5); itemsEffect.startDate = `${r.getFullYear()}-${addZero(r.getMonth() + 1)}-${addZero(r.getDate())}`; var s = []; o = o.getTime(), r = r.getTime(); for (var d = o; r <= d; d -= 864e5) { var i = new Date(d); s.push(`${i.getFullYear()}-${addZero(i.getMonth() + 1)}-${addZero(i.getDate())}`) } subway.arr = subway.arr.concat(s), getAndPostItemsEffect(2e3), getAndPostSubwayData(1e3); let c = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'init', code: 200, data: null }; console.log(c), webSocket.send(JSON.stringify(c))
    } else if ('getItem' == p.type) { var l = new Date(p.startTime).getTime(); for (s = [], d = g = new Date(p.endTime).getTime(); l <= d; d -= 864e5) { i = new Date(d); var u = { itemId: p.itemId, queryTime: `${i.getFullYear()}-${addZero(i.getMonth() + 1)}-${addZero(i.getDate())}` }; s.push(u) } itemsFrom.arr = itemsFrom.arr.concat(s), keyword.arr = keyword.arr.concat(s), getAndPostItemsFrom(), getAndPostItemsFromKeyword(450) } else if ('getRepair' == p.type) {
      l = new Date(p.startTime).getTime(); var g = new Date(p.endTime).getTime(),
        h = new Map(webSocketData.itemsDays),
        D = new Set(webSocketData.subwayDays); for (d = g; l <= d; d -= 864e5) { i = `${(i = new Date(d)).getFullYear()}-${addZero(i.getMonth() + 1)}-${addZero(i.getDate())}`, D.has(i) || (webSocketData.subwayDays.push(i), subway.arr.push(i), getAndPostSubwayData(1e3)) } if (h.has(p.itemId)) {
          var y = h.get(p.itemId),
          m = new Set(y); for (d = g; l <= d; d -= 864e5) { if (i = `${(i = new Date(d)).getFullYear()}-${addZero(i.getMonth() + 1)}-${addZero(i.getDate())}`, !m.has(i)) { y.push(i); u = { itemId: p.itemId, queryTime: i }; itemsFrom.arr.push(u), keyword.arr.push(u), getAndPostItemsFrom(), getAndPostItemsFromKeyword(450) } }
        } else { let b = []; b.push(p.itemId); for (y = [], d = g; l <= d; d -= 864e5) { i = `${(i = new Date(d)).getFullYear()}-${addZero(i.getMonth() + 1)}-${addZero(i.getDate())}`, y.push(i); u = { itemId: p.itemId, queryTime: i }; itemsFrom.arr.push(u), keyword.arr.push(u), getAndPostItemsFrom(), getAndPostItemsFromKeyword(450) } b.push(y), webSocketData.itemsDays.push(b) } findItemById(p.itemId, 2e3), console.log(webSocketData.itemsDays), console.log(webSocketData.subwayDays)
    } else if ('getPlan' == p.type) { var f = (new Date()).getTime(); $.ajax({ url: 'https://subway.simba.taobao.com/openapi/param2/1/gateway.subway/common/campaign/list$', type: 'post', async: !0, data: { token: globalData.subwayToken, _h: getHash(f), t: f }, success: function (a) { if ('200' == a.code) try { for (var t = a.result, e = [], o = 0; o < t.length; o++) if ('0' == t[o].type) { let r = { campaignId: t[o].id, title: t[o].title, status: t[o].status }; e.push(r) } var n = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'plan', code: 200, data: e } } catch (a) { n = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'plan', code: 200, data: [] } } else n = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'plan', code: 400 }; console.log(n), webSocket.send(JSON.stringify(n)) } }) } else if ('getPlanItems' == p.type) { var w = 'https://subway.simba.taobao.com/adgroup/spread/list.htm?query={"page":{"pagesize":50000,"pagenum":1},"query":{"campaignId":"{campaignId}","title":""}}'; f = (new Date()).getTime(); $.ajax({ url: w.replace('{campaignId}', p.campaignId), type: 'post', async: !0, data: { token: globalData.subwayToken, _h: getHash(f), t: f }, success: function (a) { if ('200' == a.code) try { for (var t = a.result.items, e = [], o = 0; o < t.length; o++) { let r = { imgUrl: t[o].adGroupDTO.imgUrl, linkUrl: t[o].adGroupDTO.linkUrl, title: t[o].adGroupDTO.title, adGroupId: t[o].adGroupDTO.adGroupId, productId: t[o].adGroupDTO.productId, firstCat: t[o].adGroupDTO.categoryId.split(' ')[0], price: t[o].adGroupDTO.outsideItemPrice }; e.push(r) } var n = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'planitems', code: 200, data: e } } catch (a) { n = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'planitems', code: 200, data: [] } } else n = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'planitems', code: 400 }; console.log(n), webSocket.send(JSON.stringify(n)) } }) } else if ('getAddCrowd' == p.type) {
      var I = function () {
        return (h = new $.Deferred(), a = (new Date()).getTime(), $.ajax({
          url: 'https://subway.simba.taobao.com/crowdTemplate/getLayoutExt.htm', type: 'get', async: !0, data: { productId: p.productId, bizType: '1', firstCat: p.firstCat, _h: getHash(a), t: a }, success: function (a) {
            if ('200' == a.code) try {
              let t = [],
              e = [],
              o = [],
              r = [],
              n = !0,
              s = !1,
              d = void 0; try { for (var i, c = a.result[1].dimDTOs[Symbol.iterator](); !(n = (i = c.next()).done); n = !0)'类目笔单价' == (p = i.value).name ? e = p.tagOptions : '性别' == p.name ? o = p.tagOptions : '年龄' == p.name && (r = p.tagOptions) } catch (a) { s = !0, d = a } finally { try { !n && c.return && c.return() } finally { if (s) throw d } } for (var p = 0; p < e.length; p++) for (var l = 0; l < o.length; l++) {
                var u = { dimId: o[l].dimId, tagId: o[l].tagId, tagName: o[l].tagName, optionGroupId: o[l].optionGroupId },
                g = { dimId: e[p].dimId, tagId: e[p].tagId, tagName: e[p].tagName, optionGroupId: e[p].optionGroupId }; t.push([u, g, 110])
              } for (p = 0; p < r.length; p++) for (l = 0; l < o.length; l++)u = { dimId: o[l].dimId, tagId: o[l].tagId, tagName: o[l].tagName, optionGroupId: o[l].optionGroupId }, g = { dimId: r[p].dimId, tagId: r[p].tagId, tagName: r[p].tagName, optionGroupId: r[p].optionGroupId }, t.push([u, g, 105]); h.resolve(t)
            } catch (a) { h.reject() } else h.reject()
          }
        }), h.promise()).then((a) => { console.log(a); var t = new $.Deferred; return t.resolve(), $.each(a, function (a, e) { t = t.then(function () { return delayTime(getBetweenRound(globalData.min, globalData.max)) }).then(function () { var t = new $.Deferred, a = (new Date).getTime(); return $.ajax({ url: "https://subway.simba.taobao.com/adgroupTargeting/add.htm", type: "post", async: !0, data: { adgroupId: p.adGroupId, bizType: "1", productId: p.productId, token: globalData.subwayToken, targetings: '[{"crowdDTO":{"extParam":{"firstCat":"' + p.firstCat + '"},"templateId":12,"name":"' + e[0].tagName + "+" + e[1].tagName + '","tagList":[' + JSON.stringify(e[0]) + "," + JSON.stringify(e[1]) + ']},"isDefaultPrice":0,"priceMode":1,"discount":' + e[2] + "}]", _h: getHash(a), t: a }, success: function (a) { if ("200" == a.code) try { "100001" == e[1].dimId ? S.push(a.result[0].id) : k.push(a.result[0].id), t.resolve() } catch (a) { t.reject() } else t.reject() } }), t.promise() }) }), t.promise() }); let h,
          a
      },
      T = [],
      k = [],
      S = []; (v = function () {
        return (n = new $.Deferred(), a = (new Date()).getTime(), $.ajax({ url: 'https://subway.simba.taobao.com/adgroupTargeting/findAdgroupTargetingList.htm', type: 'get', async: !0, data: { productId: p.productId, bizType: '1', adgroupId: p.adGroupId, _h: getHash(a), t: a }, success: function (a) { if ('200' == a.code) try { for (var t = a.result, e = [], o = [], r = 0; r < t.length; r++)e.push(t[r].crowdDTO.id), o.push(t[r].id); n.resolve(JSON.stringify(e), JSON.stringify(o)) } catch (a) { n.reject() } else n.reject() } }), n.promise()).then((a, t) => { var e = new $.Deferred, o = (new Date).getTime(); return $.ajax({ url: "https://subway.simba.taobao.com/adgroupTargeting/delete.htm", type: "post", async: !0, data: { adgroupId: p.adGroupId, crowds: a, productId: p.productId, bizType: "1", ids: t, token: globalData.subwayToken, _h: getHash(o), t: o }, success: function (a) { "200" == a.code ? e.resolve() : e.reject() } }), e.promise() }); let n,
          a
      })().then(() => { var s, a; $.when(I(), (s = new $.Deferred, a = (new Date).getTime(), $.ajax({ url: "https://subway.simba.taobao.com/crowdTemplate/getLayoutExt.htm?bizType=1&productId={productId}&crowdType=12&adgroupId={adgroupId}".replace("{productId}", p.productId).replace("{adgroupId}", p.adGroupId), type: "get", async: !0, data: { _h: getHash(a), t: a }, success: function (a) { if ("200" == a.code) try { for (var t, e = 0; e < a.result.length; e++)if ("28" == a.result[e].id) { for (var o = 0; o < a.result[e].dimDTOs.length; o++) { "100012" == a.result[e].dimDTOs[o].id && (t = a.result[e].dimDTOs[o].tagOptions); break } break } var r = []; for (e = 0; e < t.length; e++) { var n = { crowdDTO: { templateId: "28", name: t[e].tagName, tagList: [{ dimId: t[e].dimId, tagId: t[e].tagId, tagName: t[e].tagName, optionGroupId: t[e].optionGroupId }] }, isDefaultPrice: 0, discount: 115 }; r.push(n) } s.resolve(JSON.stringify(r)) } catch (a) { s.reject() } else s.reject() } }), s.promise()).then(function (a) { var o = new $.Deferred, t = (new Date).getTime(); return $.ajax({ url: "https://subway.simba.taobao.com/adgroupTargeting/addBatch.htm", type: "post", async: !0, data: { productId: p.productId, bizType: "1", adgroupId: p.adGroupId, targetings: a, adgroupIdList: '["' + p.adGroupId + '"]', token: globalData.subwayToken, _h: getHash(t), t: t }, success: function (a) { if ("200" == a.code) try { for (var t = a.result, e = 0; e < t.length; e++)T.push(t[e].id.toString()); o.resolve() } catch (a) { o.reject() } else o.reject() } }), o.promise() })).then(function () { var a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "addcrowd", code: 200, data: { relationG: T, priceG: k, ageG: S } }; console.log(a), webSocket.send(JSON.stringify(a)) }, function () { var a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "addcrowd", code: 400 }; console.log(a), webSocket.send(JSON.stringify(a)) }) }, () => { var a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "addcrowd", code: 400 }; console.log(a), webSocket.send(JSON.stringify(a)) })
    } else if ('getCrowdList' == p.type) {
      var v = function () {
        let r = new $.Deferred(),
        a = (new Date()).getTime(); return $.ajax({ url: 'https://subway.simba.taobao.com/adgroupTargeting/findAdgroupTargetingList.htm', type: 'get', async: !0, data: { productId: p.productId, bizType: '1', adgroupId: p.adGroupId, _h: getHash(a), t: a }, success: function (a) { if ('200' == a.code) { try { for (let t = a.result, e = 0; e < t.length; e++) { let o = { crowdId: t[e].id, dtoId: t[e].crowdDTO.id, name: t[e].crowdDTO.name, onlineStatus: t[e].crowdDTO.onlineState, discount: '0' == t[e].discount ? '100' : t[e].discount }; A.push(o) } } catch (a) { A = [] } r.resolve() } else r.reject() } }), r.promise()
      },
      A = (I = function () {
        let r = new $.Deferred(),
        a = new Date(); if (a = `${a.getFullYear()}-${addZero(a.getMonth() + 1)}-${addZero(a.getDate())}`, p.startDate == a) { t = (t = 'https://subway.simba.taobao.com/rtreport/rptBpp4pCrowdRealtimeSubwayList.htm?campaignid={campaignid}&adgroupid={adgroupid}&theDate={theDate}&traffictype={traffictype}').replace('{campaignid}', p.campaignId).replace('{adgroupid}', p.adGroupId).replace('{theDate}', p.startDate).replace('{traffictype}', p.trafficType) } else {
          var t = 'https://subway.simba.taobao.com/report/rptBpp4pCrowdSubwayList.htm?campaignid={campaignid}&adgroupid={adgroupid}&startDate={startDate}&endDate={endDate}&traffictype={traffictype}'; if (p.endDate == a && p.endDate != p.startDate) {
            let e = new Date(new Date() - 864e5); e = `${e.getFullYear()}-${addZero(e.getMonth() + 1)}-${addZero(e.getDate())}`, console.log(e), t = t.replace('{campaignid}', p.campaignId).replace('{adgroupid}', p.adGroupId).replace('{startDate}', p.startDate).replace('{endDate}', e)
              .replace('{traffictype}', p.trafficType)
          } else t = t.replace('{campaignid}', p.campaignId).replace('{adgroupid}', p.adGroupId).replace('{startDate}', p.startDate).replace('{endDate}', p.endDate)
            .replace('{traffictype}', p.trafficType)
        } let o = (new Date()).getTime(); return $.ajax({ url: t, type: 'post', async: !0, data: { token: globalData.subwayToken, _h: getHash(o), t: o }, success: function (a) { if ('200' == a.code) { try { for (let t = a.result, e = 0; e < t.length; e++) { let o = { impression: t[e].impression, click: t[e].click, cost: t[e].cost, roi: t[e].roi, cpm: t[e].cpm, cpc: t[e].cpc, coverage: t[e].coverage, ctr: t[e].ctr, directcarttotal: t[e].directcarttotal, indirectcarttotal: t[e].indirectcarttotal, carttotal: t[e].carttotal, favitemtotal: t[e].favitemtotal, favshoptotal: t[e].favshoptotal, favtotal: t[e].favtotal, directtransactionshipping: t[e].directtransactionshipping, indirecttransactionshipping: t[e].indirecttransactionshipping, transactionshippingtotal: t[e].transactionshippingtotal, indirecttransaction: t[e].indirecttransaction, directtransaction: t[e].directtransaction, transactiontotal: t[e].transactiontotal, dtoId: t[e].crowdid }; N.push(o) } } catch (a) { N = [] } r.resolve() } else r.reject() } }), r.promise()
      }, []),
      N = []; $.when(v(), I()).then(() => { var a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "crowdlist", code: 200, data: { targetingList: A, subwayList: N } }; console.log(a), webSocket.send(JSON.stringify(a)) }, () => { var a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "crowdlist", code: 400 }; console.log(a), webSocket.send(JSON.stringify(a)) })
    } else if ('getScore' == p.type) {
    v = function () {
      let t = new $.Deferred(),
      a = new Date(); if (a = `${a.getFullYear()}-${addZero(a.getMonth() + 1)}-${addZero(a.getDate())}`, p.startDate == a) { e = (e = 'https://subway.simba.taobao.com/rtreport/rptBpp4pCrowdRealtimeTotal.htm?campaignid={campaignid}&adgroupid={adgroupid}&theDate={theDate}&traffictype={traffictype}').replace('{campaignid}', p.campaignId).replace('{adgroupid}', p.adGroupId).replace('{theDate}', p.startDate).replace('{traffictype}', p.trafficType) } else {
        var e = 'https://subway.simba.taobao.com/report/rptBpp4pCrowdSubwayTotal.htm?campaignid={campaignid}&adgroupid={adgroupid}&startDate={startDate}&endDate={endDate}&traffictype={traffictype}'; if (p.endDate == a && p.endDate != p.startDate) {
          let o = new Date(new Date() - 864e5); o = `${o.getFullYear()}-${addZero(o.getMonth() + 1)}-${addZero(o.getDate())}`, console.log(o), e = e.replace('{campaignid}', p.campaignId).replace('{adgroupid}', p.adGroupId).replace('{startDate}', p.startDate).replace('{endDate}', o)
            .replace('{traffictype}', p.trafficType)
        } else e = e.replace('{campaignid}', p.campaignId).replace('{adgroupid}', p.adGroupId).replace('{startDate}', p.startDate).replace('{endDate}', p.endDate)
          .replace('{traffictype}', p.trafficType)
      } let r = (new Date()).getTime(); return $.ajax({ url: e, type: 'post', async: !0, data: { token: globalData.subwayToken, _h: getHash(r), t: r }, success: function (a) { if ('200' == a.code) { try { O = a.result.impression ? a.result.impression : '0' } catch (a) { O = '0' } t.resolve() } else t.reject() } }), t.promise()
    }, I = function () {
      return (n = new $.Deferred(), a = (new Date()).getTime(), $.ajax({
        url: 'https://subway.simba.taobao.com/creative/list.htm?adGroupId={adGroupId}&productId={productId}'.replace('{adGroupId}', p.adGroupId).replace('{productId}', p.productId), type: 'post', async: !0, data: { token: globalData.subwayToken, _h: getHash(a), t: a }, success: function (a) {
          if ('200' == a.code) {
            let t = a.result,
            e = '',
            o = []; try { e = t[0].customerId; for (let r = 0; r < t.length; r++)o.push(t[r].creativeId); n.resolve(e, o.toString()) } catch (a) { n.reject() }
          } else n.reject()
        }
      }), n.promise()).then((a, t) => { if ("" != a || "" != t) { var e = new $.Deferred, o = new Date; if (o = o.getFullYear() + "-" + addZero(o.getMonth() + 1) + "-" + addZero(o.getDate()), p.startDate == o) { r = (r = "https://subway.simba.taobao.com/report/commondList.htm?templateId=rptBpp4pCreativeRealtimeSubwayListTotal&thedate={thedate}&ids={ids}&campaignid={campaignid}&adgroupid={adgroupid}&custid={custid}&traffictype={traffictype}&mechanism=0").replace("{thedate}", p.startDate).replace("{ids}", t).replace("{campaignid}", p.campaignId).replace("{adgroupid}", p.adGroupId).replace("{custid}", a).replace("{traffictype}", p.trafficType) } else { var r = "https://subway.simba.taobao.com/report/commondList.htm?templateId=rptBpp4pCreativeSubwayListTotal&isshop=0&campaignid={campaignid}&startDate={startDate}&endDate={endDate}&ids={ids}&network={network}&searchtype=0"; if (p.endDate == o && p.endDate != p.startDate) { var n = new Date(new Date - 864e5); n = n.getFullYear() + "-" + addZero(n.getMonth() + 1) + "-" + addZero(n.getDate()), console.log(n), r = r.replace("{campaignid}", p.campaignId).replace("{startDate}", p.startDate).replace("{endDate}", n).replace("{ids}", t).replace("{network}", p.trafficType) } else r = r.replace("{campaignid}", p.campaignId).replace("{startDate}", p.startDate).replace("{endDate}", p.endDate).replace("{ids}", t).replace("{network}", p.trafficType) } var s = (new Date).getTime(); return $.ajax({ url: r, type: "post", async: !0, data: { token: globalData.subwayToken, _h: getHash(s), t: s }, success: function (a) { if ("200" == a.code) { try { G = a.result[0].impression ? a.result[0].impression : "0" } catch (a) { G = "0" } e.resolve() } else e.reject() } }), e.promise() } }); let n,
        a
    }; var O = '0',
      G = '0'; $.when(v(), I()).then(() => { var a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "score", code: 200, data: { numerator: O, denominator: G } }; console.log(a), webSocket.send(JSON.stringify(a)) }, () => { var a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "score", code: 400 }; console.log(a), webSocket.send(JSON.stringify(a)) })
    } else if ('getUpdatePrice' == p.type) {
      (v = function () {
        let e = new $.Deferred(),
        a = (new Date()).getTime(); return $.ajax({ url: 'https://subway.simba.taobao.com/adgroupTargeting/findAdgroupTargetingList.htm', type: 'get', async: !0, data: { productId: p.productId, bizType: '1', adgroupId: p.adGroupId, _h: getHash(a), t: a }, success: function (a) { if ('200' == a.code) { let t = []; try { t = a.result } catch (a) { t = [] } e.resolve(t) } else e.reject() } }), e.promise()
      })().then((a) => { var t = p.crowdIds.split(","), e = []; try { for (var o = 0; o < t.length; o++)for (var r = 0; r < a.length; r++)if (t[o] == a[r].id) { var n = { adgroupId: p.adGroupId + "", crowdDTO: { id: a[r].crowdDTO.id }, id: t[o], isDefaultPrice: 0, discount: p.discount }; e.push(n); break } } catch (a) { } var s = (new Date).getTime(); $.ajax({ url: "https://subway.simba.taobao.com/adgroupTargeting/update.htm", type: "post", async: !0, data: { productId: p.productId, bizType: "1", targetings: JSON.stringify(e), token: globalData.subwayToken, _h: getHash(s), t: s }, success: function (a) { if ("200" == a.code) var t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "updateprice", code: 200, data: a.result }; else t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "updateprice", code: 400 }; webSocket.send(JSON.stringify(t)) } }) })
    } else if ('getUpdateCrowdName' == p.type) {
      (v = function () {
        let e = new $.Deferred(),
        a = (new Date()).getTime(); return $.ajax({ url: 'https://subway.simba.taobao.com/adgroupTargeting/findAdgroupTargetingList.htm', type: 'get', async: !0, data: { productId: p.productId, bizType: '1', adgroupId: p.adGroupId, _h: getHash(a), t: a }, success: function (a) { if ('200' == a.code) { let t = []; try { t = a.result } catch (a) { t = [] } e.resolve(t) } else e.reject() } }), e.promise()
      })().then((a) => { var t = { adgroupId: p.adGroupId, name: p.name, id: p.crowdIds, productId: p.productId }; try { for (var e = 0; e < a.length; e++)if (a[e].id == p.crowdIds) { t.id = a[e].crowdDTO.id; break } } catch (a) { } var o = (new Date).getTime(); $.ajax({ url: "https://subway.simba.taobao.com/crowd/update.htm", type: "post", async: !0, data: { crowdDTO: JSON.stringify(t), token: globalData.subwayToken, _h: getHash(o), t: o }, success: function (a) { if ("200" == a.code) var t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "updatecrowdname", code: 200, data: a.result }; else t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "updatecrowdname", code: 400 }; webSocket.send(JSON.stringify(t)) } }) })
    } else if ('getDeleteCrowds' == p.type) {
      (v = function () {
        let e = new $.Deferred(),
        a = (new Date()).getTime(); return $.ajax({ url: 'https://subway.simba.taobao.com/adgroupTargeting/findAdgroupTargetingList.htm', type: 'get', async: !0, data: { productId: p.productId, bizType: '1', adgroupId: p.adGroupId, _h: getHash(a), t: a }, success: function (a) { if ('200' == a.code) { let t = []; try { t = a.result } catch (a) { t = [] } e.resolve(t) } else e.reject() } }), e.promise()
      })().then((a) => { try { for (var t = p.crowdIds.split(","), e = [], o = 0; o < t.length; o++)for (var r = 0; r < a.length; r++)if (t[o] == a[r].id) { e.push(a[r].crowdDTO.id); break } } catch (a) { } var n = (new Date).getTime(); $.ajax({ url: "https://subway.simba.taobao.com/adgroupTargeting/delete.htm", type: "post", async: !0, data: { adgroupId: p.adGroupId, crowds: JSON.stringify(e), productId: p.productId, bizType: "1", ids: JSON.stringify(t), token: globalData.subwayToken, _h: getHash(n), t: n }, success: function (a) { if ("200" == a.code) var t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "deletecrowds", code: 200, data: a.result }; else t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "deletecrowds", code: 400 }; webSocket.send(JSON.stringify(t)) } }) })
    } else if ('getUpdateStatus' == p.type) {
      (v = function () {
        let e = new $.Deferred(),
        a = (new Date()).getTime(); return $.ajax({ url: 'https://subway.simba.taobao.com/adgroupTargeting/findAdgroupTargetingList.htm', type: 'get', async: !0, data: { productId: p.productId, bizType: '1', adgroupId: p.adGroupId, _h: getHash(a), t: a }, success: function (a) { if ('200' == a.code) { let t = []; try { t = a.result } catch (a) { t = [] } e.resolve(t) } else e.reject() } }), e.promise()
      })().then((a) => { var t = p.crowdIds.split(","), e = []; try { for (var o = 0; o < t.length; o++)for (var r = 0; r < a.length; r++)if (t[o] == a[r].id) { var n = { adgroupId: p.adGroupId + "", crowdDTO: { id: a[r].crowdDTO.id }, id: t[o], onlineStatus: p.onlineStatus }; e.push(n); break } } catch (a) { } var s = (new Date).getTime(); $.ajax({ url: "https://subway.simba.taobao.com/adgroupTargeting/update.htm", type: "post", async: !0, data: { productId: p.productId, bizType: "1", targetings: JSON.stringify(e), token: globalData.subwayToken, _h: getHash(s), t: s }, success: function (a) { if ("200" == a.code) var t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "updatestatus", code: 200, data: a.result }; else t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "updatestatus", code: 400 }; webSocket.send(JSON.stringify(t)) } }) })
    } else if ('getTodayCreative' == p.type) (n = new $.Deferred(), t = (new Date()).getTime(), $.ajax({
      url: 'https://subway.simba.taobao.com/creative/list.htm?adGroupId={adGroupId}&productId={productId}'.replace('{adGroupId}', p.adGroupId).replace('{productId}', p.productId), type: 'post', async: !0, data: { token: globalData.subwayToken, _h: getHash(t), t: t }, success: function (a) {
        if ('200' == a.code) {
          let t = a.result,
          e = '',
          o = []; try { e = t[0].customerId; for (let r = 0; r < t.length; r++)o.push(t[r].creativeId); n.resolve(e, o.toString()) } catch (a) { n.reject() }
        } else n.reject()
      }
    }), n.promise()).then((a, t) => { var e = new Date; e = e.getFullYear() + "-" + addZero(e.getMonth() + 1) + "-" + addZero(e.getDate()); var o = "https://subway.simba.taobao.com/report/commondList.htm?templateId=rptBpp4pCreativeRealtimeSubwayListTotal&thedate={thedate}&ids={ids}&campaignid={campaignid}&adgroupid={adgroupid}&custid={custid}&traffictype={traffictype}&mechanism=0"; o = o.replace("{thedate}", e).replace("{ids}", t).replace("{campaignid}", p.campaignId).replace("{adgroupid}", p.adGroupId).replace("{custid}", a).replace("{traffictype}", p.trafficType); var r = (new Date).getTime(); $.ajax({ url: o, type: "post", async: !0, data: { token: globalData.subwayToken, _h: getHash(r), t: r }, success: function (a) { if ("200" == a.code) { var t = a.result; try { var e = { impression: t[0].impression ? t[0].impression : "0", click: t[0].click ? t[0].click : "0", ctr: t[0].ctr ? t[0].ctr : "0", cost: t[0].cost ? t[0].cost : "0", cpc: t[0].cpc ? t[0].cpc : "0", favtotal: t[0].favtotal ? t[0].favtotal : "0", indirectcarttotal: t[0].indirectcarttotal ? t[0].indirectcarttotal : "0", favitemtotal: t[0].favitemtotal ? t[0].favitemtotal : "0", roi: t[0].roi ? t[0].roi : "0", coverage: t[0].coverage ? t[0].coverage : "0", cpm: t[0].cpm ? t[0].cpm : "0", indirecttransaction: t[0].indirecttransaction ? t[0].indirecttransaction : "0", transactiontotal: t[0].transactiontotal ? t[0].transactiontotal : "0", indirecttransactionshipping: t[0].indirecttransactionshipping ? t[0].indirecttransactionshipping : "0", favshoptotal: t[0].favshoptotal ? t[0].favshoptotal : "0", directcarttotal: t[0].directcarttotal ? t[0].directcarttotal : "0", directtransactionshipping: t[0].directtransactionshipping ? t[0].directtransactionshipping : "0", transactionshippingtotal: t[0].transactionshippingtotal ? t[0].transactionshippingtotal : "0", carttotal: t[0].carttotal ? t[0].carttotal : "0", directtransaction: t[0].directtransaction ? t[0].directtransaction : "0" } } catch (a) { e = { impression: "0", click: "0", ctr: "0", cost: "0", cpc: "0", favtotal: "0", indirectcarttotal: "0", favitemtotal: "0", roi: "0", coverage: "0", cpm: "0", indirecttransaction: "0", transactiontotal: "0", indirecttransactionshipping: "0", favshoptotal: "0", directcarttotal: "0", directtransactionshipping: "0", transactionshippingtotal: "0", carttotal: "0", directtransaction: "0" } } var o = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "todaycreative", code: 200, data: e } } else o = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "todaycreative", code: 400 }; console.log(o), webSocket.send(JSON.stringify(o)) } }) }, () => { var a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "todaycreative", code: 400 }; console.log(a), webSocket.send(JSON.stringify(a)) }); else if ('getBeforeCreative' == p.type) {
    w = 'https://subway.simba.taobao.com/creative/list.htm?adGroupId={adGroupId}&productId={productId}', f = (new Date()).getTime(); $.ajax({
      url: w.replace('{adGroupId}', p.adGroupId).replace('{productId}', p.productId), type: 'post', async: !0, data: { token: globalData.subwayToken, _h: getHash(f), t: f }, success: function (a) {
        if ('200' == a.code) {
          let t = a.result,
          e = []; try {
            var o = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'beforecreative', code: 200, data: null }; webSocket.send(JSON.stringify(o)); for (var r = 0; r < t.length; r++)e.push(t[r].creativeId); e = e.toString(); let n = new Date(p.startDate).getTime(),
              s = new Date(p.endDate).getTime(),
              d = []; for (r = s; n <= r; r -= 864e5) {
                let i = new Date(r),
                c = { day: i = `${i.getFullYear()}-${addZero(i.getMonth() + 1)}-${addZero(i.getDate())}`, ids: e, campaignId: p.campaignId, adGroupId: p.adGroupId, network: p.trafficType }; d.push(c)
              } creative.arr = creative.arr.concat(d), getAndPostCreative()
          } catch (a) { o = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'beforecreative', code: 400 }; webSocket.send(JSON.stringify(o)) }
        } else { o = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'beforecreative', code: 400 }; webSocket.send(JSON.stringify(o)) }
      }
    })
    } else if ('getCartCnt' == p.type) { e = (new Date()).getTime(); o = `${(o = new Date(e - 864e5 - 324e5)).getFullYear()}-${addZero(o.getMonth() + 1)}-${addZero(o.getDate())}`, r = `${(r = new Date(e - 2592e6 - 324e5)).getFullYear()}-${addZero(r.getMonth() + 1)}-${addZero(r.getDate())}`; w = 'https://sycm.taobao.com/flow/v3/new/item/source/detail.json?dateRange={startDate}%7C{endDate}&dateType=recent30&pageSize=20&page={page}&order=desc&orderBy=uv&itemId={itemId}&device={device}&pageId=3.1&pPageId=3&pageLevel=2&childPageType=se_keyword&belong=all&indexCode=uv%2CcartByrCnt&token={token}&_=' + (new Date()).getTime(), I = function d(i) { let c = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1; if (i > 0) v(c).then((a) => { a = a.data; var t = !0, e = !1, o = void 0; try { for (var r, n = a[Symbol.iterator](); !(t = (r = n.next()).done); t = !0) { var s = r.value; j.push({ pageName: s.pageName.value, cartByrCnt: s.cartByrCnt.value, uv: s.uv.value }) } } catch (a) { e = !0, o = a } finally { try { !t && n.return && n.return() } finally { if (e) throw o } } d(--i, ++c) }); else { console.log(j); let a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: 'cartcnt', code: 200, data: j }; webSocket.send(JSON.stringify(a)) } }; var j = []; (v = function (a) { let e = new $.Deferred(); return setTimeout(() => { $.ajax({ url: w.replace("{startDate}", r).replace("{endDate}", o).replace("{page}", a).replace("{itemId}", p.adGroupId).replace("{device}", p.trafficType).replace("{token}", globalData.sycmToken), type: "get", success: function (a) { if (0 == a.code) e.resolve(a.data); else { var t = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "cartcnt", code: 400 }; webSocket.send(JSON.stringify(t)), e.reject() } } }) }, getBetweenRound(globalData.min, globalData.max)), e.promise() })(1).then((a) => { var t = a.recordCount / 20; if (0 < t) I(t); else { a = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token, type: "cartcnt", code: 200, data: [] }; webSocket.send(JSON.stringify(a)) } }) }}
  }
} sokcet()
'use strict'; function getTokFn(t) { return t || (t = new $.Deferred()), $.ajax({ url: 'https://subway.simba.taobao.com/bpenv/getLoginUserInfo.htm', type: 'get', async: !0, success: function (e) { e.code == 200 ? (globalData.subwayToken = e.result.token, globalData.runAsUserId = e.result.outsideNumID, globalData.hash = { hash: e.result.hash, pin: e.result.pin }, t.resolve()) : e.code != 601 && e.code != 606 || (globalData.flag = !0, t.reject()) }, error: function () { globalData.flag = !0, t.reject() } }), t.promise() } function getNickName(t) { return t || (t = new $.Deferred()), $.ajax({ url: 'https://subway.simba.taobao.com/bpenv/getLoginUserInfo.htm', type: 'get', async: !0, success: function (e) { e.code == 200 ? (globalData.runAsUserId = e.result.outsideNumID, t.resolve()) : e.code != 601 && e.code != 606 || t.reject() }, error: function () { t.reject() } }), t.promise() } function sycmLogout() { $.ajax({ url: 'https://login.taobao.com/member/logout.jhtml', type: 'get', async: !0, success: function (e) { console.log('退出') } }) } function getShop(o) { return o || (o = new $.Deferred()), $.ajax({ url: `https://sycm.taobao.com/custom/menu/getViewMode.json?_=${  (new Date()).getTime()}`, type: 'get', async: !0, success: function (e) { e.code == 0 ? getNickName().then(() => getTaobaoSearch()).then((e, t) => { let a = { data: { runAsShopTitle: t, runAsShopId: e } }; o.resolve(a) }) : e.code == 5810 && (globalData.subwayTokenData.runAsShopTitle != null && window.location.reload(), o.reject()) }, error: function () { globalData.subwayTokenData.runAsShopTitle != null && window.location.reload() } }), o.promise() } function testSycmLoginFn(a) { return a || (a = new $.Deferred()), $.ajax({ type: 'get', url: 'https://sycm.taobao.com/portal/home.htm', async: !0, success: function (e) { let t = ($(e).filter((e, t) => "microdata" == $(t).attr("name")).attr('content') || '').match(/legalityToken=([\d\D]*);/i)[1] || ''; t ? (globalData.sycmToken = t, a.resolve()) : (globalData.flag = !0, a.reject()) }, error: function () { globalData.flag = !0, a.reject() } }), a.promise() } function getTaobaoSearch(t) {
  t || (t = new $.Deferred()); let e = localStorage.getItem(globalData.runAsUserId); if (e) {
    let a = e.split('|,|')[0],
      o = e.split('|,|')[1]; t.resolve(a, o)
  } else $.ajax({ url: `https://sycm.taobao.com/custom/menu/getPersonalView.json?token=${  globalData.sycmToken  }&date=${  (new Date()).getTime()}`, type: 'get', async: !0, success: function (e) { e.code == 0 && globalData.runAsUserId == e.data.runAsUserId && (localStorage.setItem(globalData.runAsUserId, `${e.data.runAsShopId}|,|${e.data.runAsShopTitle}`), t.resolve(e.data.runAsShopId, e.data.runAsShopTitle)) } }); return t.promise()
}
'use strict'; var subway = { arr: [], data: [], needPost: !0, needGet: !0 }; function getAndPostSubwayData(t) { subway.needGet && (subway.needGet = !1, queueGetSubway(t)) } function queueGetSubway(f) { if (subway.arr.length > 0) { let p = subway.arr.shift(); return getSubwayPage(f, p).then((t) => { for (var c = Math.ceil(t / f), a = new $.Deferred(), e = [], b = [], w = [], r = 0; r < c; r++)e[r] = r * f; return a.resolve(), $.each(e, (t, d) => { a = a.then(function () { return getSubwayDataByOffset(d, f, p) }).then(function (t) { var a = new $.Deferred; if (null != t) { for (var e = [], r = [], o = 0; o < t.length; o++)"4" == t[o].network ? e.push(t[o]) : "1" == t[o].network && r.push(t[o]); w = w.concat(r), b = b.concat(e) } if (d == (c - 1) * f) { if (0 == w.length) { (u = []).push(n = { transactionshippingtotal: "0", cost: "0", click: "0", favtotal: "0", carttotal: "0", bidwordstr: "", linkurl: "", bidwordid: "0", iid: "0" }); var n = { shopId: globalData.subwayTokenData.runAsShopId, datatime: p, terminal: 1, data: u }; subway.data.push(n) } else { for (var s = 0; s < w.length; s++) { n = { transactionshippingtotal: w[s].transactionshippingtotal ? w[s].transactionshippingtotal : "0", cost: w[s].cost ? w[s].cost : "0", click: w[s].click ? w[s].click : "0", favtotal: w[s].favtotal ? w[s].favtotal : "0", carttotal: w[s].carttotal ? w[s].carttotal : "0", bidwordstr: w[s].bidwordstr ? w[s].bidwordstr : "", linkurl: w[s].linkurl ? w[s].linkurl : "", bidwordid: w[s].bidwordid ? w[s].bidwordid : "0", iid: w[s].linkurl ? 1 * w[s].linkurl.match(/id=([\d\D]*)/)[1] : 0 }; w[s] = n } var i = dataSlice(w); for (s = 0; s < i.length; s++) { n = { shopId: globalData.subwayTokenData.runAsShopId, datatime: p, terminal: 1, data: i[s] }; subway.data.push(n) } } if (0 == b.length) { var u; (u = []).push(n = { transactionshippingtotal: "0", cost: "0", click: "0", favtotal: "0", carttotal: "0", bidwordstr: "", linkurl: "", bidwordid: "0", iid: "0" }); n = { shopId: globalData.subwayTokenData.runAsShopId, datatime: p, terminal: 2, data: u }; subway.data.push(n) } else { for (s = 0; s < b.length; s++) { n = { transactionshippingtotal: b[s].transactionshippingtotal ? b[s].transactionshippingtotal : "0", cost: b[s].cost ? b[s].cost : "0", click: b[s].click ? b[s].click : "0", favtotal: b[s].favtotal ? b[s].favtotal : "0", carttotal: b[s].carttotal ? b[s].carttotal : "0", bidwordstr: b[s].bidwordstr ? b[s].bidwordstr : "", linkurl: b[s].linkurl ? b[s].linkurl : "", bidwordid: b[s].bidwordid ? b[s].bidwordid : "0", iid: b[s].linkurl ? 1 * b[s].linkurl.match(/id=([\d\D]*)/)[1] : 0 }; b[s] = n } var l = dataSlice(b); for (s = 0; s < l.length; s++) { n = { shopId: globalData.subwayTokenData.runAsShopId, datatime: p, terminal: 2, data: l[s] }; subway.data.push(n) } } } return a.resolve(), a.promise() }) }), a.promise() }).then(() => { postSubway(), queueGetSubway(f) }) } subway.needGet = !0 } function postSubway() { subway.needPost && (subway.needPost = !1, queuePostSubway()) } function getSubwayPage(a, e, r) { r || (r = new $.Deferred()); let t = (new Date()).getTime(); return setTimeout(() => { $.ajax({ url: getCountSubway.replace(/\{startDate\}/g, e).replace(/\{endDate\}/g, e).replace(/\{pageSize\}/g, a), type: 'post', async: !0, data: { templateId: 'countOfflineBidwordList', sla: 'json', isAjaxRequest: !0, token: globalData.subwayToken, _referer: subWayReferer.replace(/\{start\}/g, e).replace(/\{end\}/g, e), _h: getHash(t), t: t }, success: function (t) { t.code == 200 ? t.result == 0 ? r.resolve(1) : r.resolve(t.result) : getSubwayPage(a, e, r) }, error: function () { getSubwayPage(a, e, r) } }) }, getBetweenRound(globalData.min, globalData.max)), r.promise() } function getSubwayDataByOffset(a, e, r, o) { o || (o = new $.Deferred()); let t = (new Date()).getTime(); return setTimeout(() => { $.ajax({ url: subWayUrl.replace(/\{startDate\}/g, r).replace(/\{endDate\}/g, r).replace(/\{offset\}/g, a).replace(/\{pageSize\}/g, e), type: 'post', async: !0, data: { sla: 'json', isAjaxRequest: !0, token: globalData.subwayToken, _referer: subWayReferer.replace(/\{start\}/g, r).replace(/\{end\}/g, r), _h: getHash(t), t: t }, success: function (t) { t.code == 200 ? o.resolve(t.result.sublist) : t.code == 601 ? o.reject() : getSubwayDataByOffset(a, e, r, o) }, error: function () { getSubwayDataByOffset(a, e, r, o) } }) }, getBetweenRound(globalData.min, globalData.max)), o.promise() } function queuePostSubway() { if (subway.data.length > 0) { let a = subway.data.shift(); setTimeout(() => { $.ajax({ url: postCarDataUpUrl, type: 'post', async: !0, data: { shopId: a.shopId, datatime: a.datatime, itemId: a.itemId, terminal: a.terminal, data: JSON.stringify(a) }, success: function (t) { t.ret != 200 && (subway.data.unshift(a), queuePostSubway()) }, error: function () { } }), subway.data.length > 0 ? subway.data[0].datatime != a.datatime && subwayVer(a) : subwayVer(a), queuePostSubway() }, globalData.time) } else subway.needPost = !0 } function subwayVer(a) { $.ajax({ url: postCarDataUpUrlVer, type: 'post', async: !0, data: { shopId: a.shopId, datatime: a.datatime }, success: function (t) { t.ret == 200 ? t.data.code == 400 && (subway.arr.unshift(a.datatime), getAndPostSubwayData(5e3)) : setTimeout(() => { subwayVer(a) }, getBetweenRound(globalData.min, globalData.max)) }, error: function () { } }) }
'use strict'; var itemsEffect = { startDate: '', endDate: '', data: [] }; function getAndPostItemsEffect(e) { e > 2e3 && (e = 2e3), getItemsEffect(0, e).then(() => { postItemsEffectData() }) } function getItemsEffect(o, i) { return getItemsEffectTotalPage(o, i).then((e) => { for (var a = new $.Deferred(), t = [], r = 0; r < e; r++)t[r] = r + 1; return a.resolve(), $.each(t, (e, t) => { a = a.then(function () { return getItemsEffectByPage(o, t, i) }).then(function (e, t) { var a = new $.Deferred; if (0 < t.length) { for (var r = [], o = 0; o < t.length; o++) { var i = { id: t[o].itemModel.id, title: t[o].itemModel.title, itemDetailUrl: t[o].itemModel.itemDetailUrl, pictUrl: t[o].itemModel.pictUrl, reservePrice: t[o].itemModel.reservePrice, publishTime: t[o].itemModel.publishTime }; t[o] = i, r.push(t[o]) } var n = dataSlice(r); for (o = 0; o < n.length; o++) { i = { shopId: globalData.subwayTokenData.runAsShopId, datatime: e, data: n[o] }; itemsEffect.data.push(i) } } else { i = { shopId: globalData.subwayTokenData.runAsShopId, datatime: e, data: [] }; itemsEffect.data.push(i) } return a.resolve(), a.promise() }) }), a.promise() }) } function getItemsEffectTotalPage(t, a, r) { return r || (r = new $.Deferred()), setTimeout(() => { $.ajax({ url: getItemsEffectTpl.replace('{startDate}', itemsEffect.startDate).replace('{endDate}', itemsEffect.endDate).replace('{device}', t).replace('{page}', 1)
.replace('{pageLimit}', a)
.replace('{token}', globalData.sycmToken), get: 'get', async: !0, success: function (e) { e.code == 0 ? e.data.recordCount == 0 ? r.resolve(1) : r.resolve(Math.ceil(e.data.recordCount / a)) : e.code == 5810 || e.code == 5903 ? r.reject() : getItemsEffectTotalPage(t, a, r) }, error: function () { getItemsEffectTotalPage(t, a, r) } }) }, getBetweenRound(globalData.min, globalData.max)), r.promise() } function getItemsEffectByPage(t, a, r, o) { return o || (o = new $.Deferred()), setTimeout(() => { $.ajax({ url: getItemsEffectTpl.replace('{startDate}', itemsEffect.startDate).replace('{endDate}', itemsEffect.endDate).replace('{device}', t).replace('{page}', a)
.replace('{pageLimit}', r)
.replace('{token}', globalData.sycmToken), get: 'get', async: !0, success: function (e) { e.code == 0 ? o.resolve(itemsEffect.endDate, e.data.data) : e.code == 5810 ? o.reject() : getItemsEffectByPage(t, a, r, o) }, error: function () { getItemsEffectByPage(t, a, r, o) } }) }, getBetweenRound(globalData.min, globalData.max)), o.promise() } function postItemsEffectData() { if (itemsEffect.data.length > 0) { let t = itemsEffect.data.shift(); setTimeout(() => { $.ajax({ url: postItemsEffectDetailUpUrl, type: 'post', async: !0, data: { shopId: t.shopId, datatime: t.datatime, data: JSON.stringify(t), type: 0 }, success: function (e) { e.ret != 200 && (itemsEffect.data.unshift(t), postItemsEffectData()) }, error: function () { } }), itemsEffect.data.length == 0 && itemsEffectVer(), postItemsEffectData() }, globalData.time) } } function itemsEffectVer() { $.ajax({ url: postItemsEffectDetailUpVer, type: 'post', async: !0, data: { shopId: globalData.subwayTokenData.runAsShopId }, success: function (e) { e.ret == 200 ? e.data.code == 400 && getAndPostItemsEffect(2e3) : setTimeout(() => { itemsEffectVer() }, getBetweenRound(globalData.min, globalData.max)) }, error: function () { } }) } function findItemById(n, o) {
  o > 2e3 && (o = 2e3); let e = (new Date()).getTime(),
    t = new Date(e - 864e5 - 324e5); itemsEffect.endDate = `${t.getFullYear()}-${addZero(t.getMonth() + 1)}-${addZero(t.getDate())}`; let a = new Date(e - 2592e6 - 324e5); itemsEffect.startDate = `${a.getFullYear()}-${addZero(a.getMonth() + 1)}-${addZero(a.getDate())}`, getItemsEffectTotalPage(0, o).then((e) => { for (var a = new $.Deferred(), t = [], r = 0; r < e; r++)t[r] = r + 1; return a.resolve(), $.each(t, (e, t) => { a = a.then(function () { return getItemsEffectByPage(0, t, o) }).then(function (e, t) { var a = new $.Deferred, r = !1; if (0 < t.length) for (var o, i = 0; i < t.length; i++)if (t[i].itemModel.id == n) { r = !0, o = { shopId: globalData.subwayTokenData.runAsShopId, datatime: itemsEffect.endDate, data: [{ id: t[i].itemModel.id, title: t[i].itemModel.title, itemDetailUrl: t[i].itemModel.itemDetailUrl, pictUrl: t[i].itemModel.pictUrl, reservePrice: t[i].itemModel.reservePrice, publishTime: t[i].itemModel.publishTime }] }, $.ajax({ url: postItemsEffectDetailUpUrl, type: "post", async: !0, data: { shopId: o.shopId, datatime: o.datatime, data: JSON.stringify(o), type: 1 }, success: function (e) { console.log(o) } }); break } return r ? a.reject() : a.resolve(), a.promise() }) }), a.promise() })
}
'use strict'; var itemsFrom = { data: [], arr: [], needPost: !0, needGet: !0 }; function getAndPostItemsFrom() { itemsFrom.needGet && (itemsFrom.needGet = !1, queueGetItemsFrom()) } function queueGetItemsFrom() { if (itemsFrom.arr.length > 0) { let e = itemsFrom.arr.shift(); return getItemsFrom(1, e).then(() => getItemsFrom(2, e)).then(() => { postItemsFrom(), queueGetItemsFrom() }) } itemsFrom.needGet = !0 } function postItemsFrom() { itemsFrom.needPost && (itemsFrom.needPost = !1, queuePostItemsFrom()) } function getItemsFrom(o, s, i) { return i || (i = new $.Deferred()), setTimeout(() => { $.ajax({ url: getItemFromToTpl.replace('{device}', o).replace('{itemId}', s.itemId).replace(/\{startDate\}/g, s.queryTime).replace(/\{endDate\}/g, s.queryTime)
.replace('{token}', globalData.sycmToken), type: 'get', async: !0, success: function (e) { if (e.code == 0) { if (e.data.list.length > 0) { for (var t = 0; t < e.data.list.length; t++) { var a = { sourceId: e.data.list[t].sourceId, sourceName: e.data.list[t].sourceName, payBuyerCnt: e.data.list[t].payBuyerCnt, payRate: e.data.list[t].payRate, favBuyerCnt: e.data.list[t].favBuyerCnt, addCartBuyerCnt: e.data.list[t].addCartBuyerCnt, uv: e.data.list[t].uv, pv: e.data.list[t].pv }; e.data.list[t] = a } let r = dataSlice(e.data.list); for (t = 0; t < r.length; t++) { a = { shopId: globalData.subwayTokenData.runAsShopId, datatime: s.queryTime, itemId: s.itemId, terminal: o, data: r[t] }; itemsFrom.data.push(a) } } else { (m = []).push({ sourceId: '0', sourceName: '', payBuyerCnt: '0', payRate: '0', favBuyerCnt: '0', addCartBuyerCnt: '0', uv: '0', pv: '0' }); a = { shopId: globalData.subwayTokenData.runAsShopId, datatime: s.queryTime, itemId: s.itemId, terminal: o, data: m }; itemsFrom.data.push(a) } i.resolve() } else if (e.code == 5903) { var m; (m = []).push({ sourceId: '0', sourceName: '', payBuyerCnt: '0', payRate: '0', favBuyerCnt: '0', addCartBuyerCnt: '0', uv: '0', pv: '0' }); a = { shopId: globalData.subwayTokenData.runAsShopId, datatime: s.queryTime, itemId: s.itemId, terminal: o, data: m }; itemsFrom.data.push(a), i.resolve() } else e.code == 5810 ? i.reject() : getItemsFrom(o, s, i) }, error: function () { getItemsFrom(o, s, i) } }) }, getBetweenRound(globalData.min, globalData.max)), i.promise() } function queuePostItemsFrom() { if (itemsFrom.data.length > 0) { let t = itemsFrom.data.shift(); setTimeout(() => { $.ajax({ url: postListFlowFromUpUrl, type: 'post', async: !0, data: { shopId: t.shopId, datatime: t.datatime, itemId: t.itemId, terminal: t.terminal, data: JSON.stringify(t) }, success: function (e) { e.ret != 200 && (itemsFrom.data.unshift(t), queuePostItemsFrom()) }, error: function () { } }), itemsFrom.data.length > 0 ? itemsFrom.data[0].datatime != t.datatime && itemsFromVer(t) : itemsFrom.data.length == 0 && t.terminal == 2 && itemsFromVer(t), queuePostItemsFrom() }, globalData.time) } else itemsFrom.needPost = !0 } function itemsFromVer(a) { $.ajax({ url: postListFlowFromUpVer, type: 'post', async: !0, data: { shopId: a.shopId, datatime: a.datatime, itemId: a.itemId }, success: function (e) { if (e.ret == 200) { if (e.data.code == 400) { let t = { itemId: a.itemId, queryTime: a.datatime }; itemsFrom.arr.unshift(t), getAndPostItemsFrom() } } else setTimeout(() => { itemsFromVer(a) }, getBetweenRound(globalData.min, globalData.max)) }, error: function () { } }) }
'use strict'; var keyword = { data: [], arr: [], needGet: !0, needPost: !0 }; function getAndPostItemsFromKeyword(e) { e > 450 && (e = 450), keyword.needGet && (keyword.needGet = !1, queueGetKeyword(e)) } function queueGetKeyword(e) { if (keyword.arr.length > 0) { let t = keyword.arr.shift(); return getKeyword(1, t, e).then(() => getKeyword(2, t, e)).then(() => { postKeyword(), queueGetKeyword(e) }) } keyword.needGet = !0 } function postKeyword() { keyword.needPost && (keyword.needPost = !1, queuePostKeyword()) } function getKeyword(s, r, o) { return getKeywordTotalPage(s, r.itemId, o, r.queryTime).then((i) => { for (var t = new $.Deferred(), e = [], u = [], a = 0; a < i; a++)e[a] = a + 1; return t.resolve(), $.each(e, (e, c) => { t = t.then(function () { return getKeywordByPage(c, s, r.itemId, o, r.queryTime) }).then(function (e, t, a) { var r = new $.Deferred; try { if (0 < t.length) u = u.concat(t); else { var o = []; o.push({ payAmt: "0", payBuyerCnt: "0", payRate: "0", keyword: "", uv: "0", payItemQty: "0", bounceRate: "0", pv: "0", avgPv: "0", clickCnt: "0", clickRate: "0", expose: "0", avgSeRank: "0" }); var n = { shopId: globalData.subwayTokenData.runAsShopId, datatime: e, itemId: a, terminal: s, data: o }; keyword.data.push(n) } if (c == i) { for (var d = 0; d < u.length; d++) { n = { payAmt: u[d].payAmt ? u[d].payAmt : "0", payBuyerCnt: u[d].payBuyerCnt ? u[d].payBuyerCnt : "0", payRate: u[d].payRate ? u[d].payRate : "0", keyword: u[d].keyword ? u[d].keyword : "", uv: u[d].uv ? u[d].uv : "0", payItemQty: u[d].payItemQty ? u[d].payItemQty : "0", bounceRate: u[d].bounceRate ? u[d].bounceRate : "0", pv: u[d].pv ? u[d].pv : "0", avgPv: u[d].avgPv ? u[d].avgPv : "0", clickCnt: u[d].clickCnt ? u[d].clickCnt : "0", clickRate: u[d].clickRate ? u[d].clickRate : "0", expose: u[d].expose ? u[d].expose : "0", avgSeRank: u[d].avgSeRank ? u[d].avgSeRank : "0" }; u[d] = n } var y = dataSlice(u); for (d = 0; d < y.length; d++) { n = { shopId: globalData.subwayTokenData.runAsShopId, datatime: e, itemId: a, terminal: s, data: y[d] }; keyword.data.push(n) } } } catch (e) { console.log(t) } return r.resolve(), r.promise() }) }), t.promise() }) } function getKeywordTotalPage(t, a, r, o, n) { return n || (n = new $.Deferred()), setTimeout(() => { $.ajax({ url: getItemKeywordTpl.replace('{currentPage}', 1).replace('{device}', t).replace('{itemId}', a).replace(/\{startDate\}/g, o)
.replace(/\{endDate\}/g, o)
.replace('{token}', globalData.sycmToken)
.replace('{pageSize}', r), type: 'get', async: !0, success: function (e) { e.code == 0 ? e.data.totalPage == 0 ? n.resolve(1) : n.resolve(e.data.totalPage) : e.code == 5903 ? n.resolve(1) : e.code == 5810 ? n.reject() : getKeywordTotalPage(t, a, r, o, n) }, error: function () { getKeywordTotalPage(t, a, r, o, n) } }) }, getBetweenRound(globalData.min, globalData.max)), n.promise() } function getKeywordByPage(t, a, r, o, n, d) { return d || (d = new $.Deferred()), setTimeout(() => { $.ajax({ url: getItemKeywordTpl.replace('{currentPage}', t).replace('{device}', a).replace('{itemId}', r).replace(/\{startDate\}/g, n)
.replace(/\{endDate\}/g, n)
.replace('{token}', globalData.sycmToken)
.replace('{pageSize}', o), type: 'get', async: !0, success: function (e) { e.code == 0 ? d.resolve(n, e.data.list, r) : e.code == 5903 ? d.resolve(n, [], r) : e.code == 5810 ? d.reject() : getKeywordByPage(t, a, r, o, n, d) }, error: function () { getKeywordByPage(t, a, r, o, n, d) } }) }, getBetweenRound(globalData.min, globalData.max)), d.promise() } function queuePostKeyword() { if (keyword.data.length > 0) { let t = keyword.data.shift(); setTimeout(() => { $.ajax({ url: postItemKeywordsUpUrl, type: 'post', async: !0, data: { shopId: t.shopId, datatime: t.datatime, itemId: t.itemId, terminal: t.terminal, data: JSON.stringify(t) }, success: function (e) { e.ret != 200 && (keyword.data.unshift(t), queuePostKeyword()) }, error: function () { } }), keyword.data.length > 0 ? keyword.data[0].datatime != t.datatime && keywordVer(t) : keyword.data.length == 0 && t.terminal == 2 && keywordVer(t), queuePostKeyword() }, globalData.time) } else keyword.needPost = !0 } function keywordVer(a) { $.ajax({ url: postItemKeywordsUpVer, type: 'post', async: !0, data: { shopId: a.shopId, datatime: a.datatime, itemId: a.itemId }, success: function (e) { if (e.ret == 200) { if (e.data.code == 400) { let t = { itemId: a.itemId, queryTime: a.datatime }; keyword.arr.unshift(t), getAndPostItemsFromKeyword(450) } } else setTimeout(() => { keywordVer(a) }, getBetweenRound(globalData.min, globalData.max)) }, error: function () { } }) }
'use strict'; var creative = { data: [], arr: [], needGet: !0, needPost: !0 }; function getAndPostCreative() { creative.needGet && (creative.needGet = !1, queueGetCreative()) } function queueGetCreative() { creative.arr.length > 0 ? getCreative(creative.arr.shift()).then(() => { postCreative(), queueGetCreative() }) : creative.needGet = !0 } function postCreative(t) { creative.needPost && (creative.needPost = !1, queuePostCreative(t)) } function getCreative(i, r) { r || (r = new $.Deferred()); return setTimeout(() => { $.ajax({ url: 'https://subway.simba.taobao.com/report/commondList.htm?templateId=rptBpp4pCreativeSubwayListTotal&isshop=0&campaignid={campaignid}&startDate={startDate}&endDate={endDate}&ids={ids}&network={network}&searchtype=0'.replace('{campaignid}', i.campaignId).replace('{startDate}', i.day).replace('{endDate}', i.day).replace('{ids}', i.ids)
.replace('{network}', i.network), type: 'post', async: !0, data: { token: globalData.subwayToken }, success: function (t) { if ('200' == t.code) { let a = t.result; try { var e = { day: i.day, ids: i.ids, campaignId: i.campaignId, adGroupId: i.adGroupId, network: i.network, data: { impression: a[0].impression ? a[0].impression : '0', click: a[0].click ? a[0].click : '0', ctr: a[0].ctr ? a[0].ctr : '0', cost: a[0].cost ? a[0].cost : '0', cpc: a[0].cpc ? a[0].cpc : '0', favtotal: a[0].favtotal ? a[0].favtotal : '0', indirectcarttotal: a[0].indirectcarttotal ? a[0].indirectcarttotal : '0', favitemtotal: a[0].favitemtotal ? a[0].favitemtotal : '0', roi: a[0].roi ? a[0].roi : '0', coverage: a[0].coverage ? a[0].coverage : '0', cpm: a[0].cpm ? a[0].cpm : '0', indirecttransaction: a[0].indirecttransaction ? a[0].indirecttransaction : '0', transactiontotal: a[0].transactiontotal ? a[0].transactiontotal : '0', indirecttransactionshipping: a[0].indirecttransactionshipping ? a[0].indirecttransactionshipping : '0', favshoptotal: a[0].favshoptotal ? a[0].favshoptotal : '0', directcarttotal: a[0].directcarttotal ? a[0].directcarttotal : '0', directtransactionshipping: a[0].directtransactionshipping ? a[0].directtransactionshipping : '0', transactionshippingtotal: a[0].transactionshippingtotal ? a[0].transactionshippingtotal : '0', carttotal: a[0].carttotal ? a[0].carttotal : '0', directtransaction: a[0].directtransaction ? a[0].directtransaction : '0' } } } catch (t) { e = { day: i.day, ids: i.ids, campaignId: i.campaignId, adGroupId: i.adGroupId, network: i.network, data: { impression: '0', click: '0', ctr: '0', cost: '0', cpc: '0', favtotal: '0', indirectcarttotal: '0', favitemtotal: '0', roi: '0', coverage: '0', cpm: '0', indirecttransaction: '0', transactiontotal: '0', indirecttransactionshipping: '0', favshoptotal: '0', directcarttotal: '0', directtransactionshipping: '0', transactionshippingtotal: '0', carttotal: '0', directtransaction: '0' } } } creative.data.push(e), r.resolve() } else r.reject() }, error: function () { getCreative(i, r) } }) }, getBetweenRound(globalData.min, globalData.max)), r.promise() } function queuePostCreative() { if (creative.data.length > 0) { let a = creative.data.shift(); setTimeout(() => { $.ajax({ url: postCreativeUpUrl, type: 'post', async: !0, data: { shopId: globalData.subwayTokenData.runAsShopId, campaignId: a.campaignId, adGroupId: a.adGroupId, datatime: a.day, trafficType: a.network, data: JSON.stringify(a.data) }, success: function (t) { t.ret == 200 && t.data.code != 200 && (creative.data.unshift(a), queuePostCreative()) }, error: function () { window.location.reload() } }), queuePostCreative() }, globalData.time) } else creative.needPost = !0 }
'use strict'; function getServerData(c) {
  return c || (c = new $.Deferred()), $.ajax({
    url: postDataVerUrl,
type: 'post',
async: !0,
data: { shopId: globalData.subwayTokenData.runAsShopId },
success: function (e) {
      if (e.ret == 200) {if (globalData.min = e.data.min_num, globalData.max = e.data.max_num, globalData.time = e.data.up_date_time, globalData.num = e.data.up_data_num, e.data.data.focstatus && !e.data.data.dataistrue) {
      globalData.dataIsOk = e.data.data.dataistrue, globalData.startDate = e.data.data.start_date, globalData.endDate = e.data.data.end_date; let a = e.data.data.itemArr ? e.data.data.itemArr : []; if (a.length > 0) for (var t = 0; t < a.length; t++)globalData.items.push(a[t].itemid); else globalData.items = []; let o = new Date(globalData.startDate).getTime(); for (t = new Date(globalData.endDate).getTime(); o <= t; t -= 864e5) { let r = new Date(t); globalData.allDays.push(`${r.getFullYear()}-${addZero(r.getMonth() + 1)}-${addZero(r.getDate())}`) } subway.arr = globalData.allDays.slice(); let s = (new Date()).getTime(),
        n = new Date(s - 864e5 - 324e5); itemsEffect.endDate = `${n.getFullYear()}-${addZero(n.getMonth() + 1)}-${addZero(n.getDate())}`; let l = new Date(s - 2592e6 - 324e5); itemsEffect.startDate = `${l.getFullYear()}-${addZero(l.getMonth() + 1)}-${addZero(l.getDate())}`; let d = []; for (t = 0; t < globalData.items.length; t++) for (let u = 0; u < globalData.allDays.length; u++) { let i = { itemId: globalData.items[t], queryTime: globalData.allDays[u] }; d.push(i) } itemsFrom.arr = itemsFrom.arr.concat(d), keyword.arr = keyword.arr.concat(d), c.resolve()
      } else c.reject();} else setTimeout(() => { getServerData(c) }, getBetweenRound(globalData.min, globalData.max))
    },
error: function () { setTimeout(() => { getServerData(c) }, getBetweenRound(globalData.min, globalData.max)) }
  }), c.promise()
} function backRun() {
  globalData.flag && (globalData.flag = !1, getTokFn().then(() => getShop()).then((e) => { globalData.subwayTokenData = e.data }).then(() => testSycmLoginFn())
    .then(() => { let e = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token }; return console.log(e), webSocket.send(JSON.stringify(e)), getServerData() })
    .then(() => { getAndPostItemsEffect(2e3), getAndPostSubwayData(1e3), globalData.items.length > 0 && (getAndPostItemsFrom(), getAndPostItemsFromKeyword(450)) }))
} chrome.webRequest.onBeforeSendHeaders.addListener((e) => { if ('xmlhttprequest' === e.type) { for (var a = !1, t = 0; t < e.requestHeaders.length; ++t) if ('referer' === e.requestHeaders[t].name) { a = !0, e.requestHeaders[t].value = 'https://sycm.taobao.com/portal/home.htm'; break } return a || e.requestHeaders.push({ name: 'referer', value: 'https://sycm.taobao.com/portal/home.htm' }), { requestHeaders: e.requestHeaders } } }, { urls: ['https://sycm.taobao.com/custom/menu/*'] }, ['blocking', 'requestHeaders']), chrome.webRequest.onBeforeSendHeaders.addListener((e) => { if ('xmlhttprequest' === e.type) { for (var a = !1, t = 0; t < e.requestHeaders.length; ++t) if ('referer' === e.requestHeaders[t].name) { a = !0, e.requestHeaders[t].value = 'https://subway.simba.taobao.com/'; break } return a || e.requestHeaders.push({ name: 'referer', value: 'https://subway.simba.taobao.com/' }), { requestHeaders: e.requestHeaders } } }, { urls: ['https://subway.simba.taobao.com/openapi/param2/1/gateway.subway/common/campaign/*'] }, ['blocking', 'requestHeaders']), chrome.runtime.onMessageExternal.addListener((e, a, t) => { if ('getShopInfo' == e.type) { if (globalData.subwayTokenData.runAsShopId) var o = { code: 200, shopInfo: globalData.subwayTokenData }; else o = { code: 400 }; t(o) } else if ('getLayoutExt' == e.type) (n = new $.Deferred(), $.ajax({ url: 'https://subway.simba.taobao.com/crowdTemplate/getLayoutExt.htm?productId=101001005&bizType=1&firstCat={firstCat}'.replace('{firstCat}', e.firstCat), type: 'get', async: !0, success: function (e) { '200' == e.code ? n.resolve(e.result) : n.reject() } }), n.promise()).then((r) => { var s = new $.Deferred; return $.ajax({ url: "https://subway.simba.taobao.com/bidword/list.htm?campaignId={campaignId}&adGroupId={adGroupId}&queryWord=".replace("{campaignId}", e.campaignId).replace("{adGroupId}", e.adGroupId), type: "get", async: !0, success: function (e) { if ("200" == e.code) { for (var a = e.result, t = [], o = 0; o < a.length; o++)t.push(a[o].word); s.resolve(r, JSON.stringify(t)) } else s.reject() } }), s.promise() }).then((e, a) => { t({ code: 200, layout: e, wordList: a }) }, () => { t({ code: 400 }) }); else if ('getCrowdCount' == e.type) $.ajax({ url: 'https://subway.simba.taobao.com/crowd/getCrowdEstimateWithWord.htm', type: 'post', async: !0, data: { productId: '101001005', bizType: '1', wordList: e.wordList, selectTagOptions: JSON.stringify(e.selectTagOptions), token: globalData.subwayToken }, success: function (e) { if ('200' == e.code) { var a = { code: 200, result: e.result }; t(a) } else { t(a = { code: 400 }) } } }); else if ('addCrowd' == e.type) { let r = { crowdDTO: { extParam: { firstCat: e.firstCat }, templateId: 12, name: e.name, tagList: e.tagList }, isDefaultPrice: 0, priceMode: 1, discount: e.discount }; $.ajax({ url: 'https://subway.simba.taobao.com/adgroupTargeting/add.htm', type: 'post', async: !0, data: { adgroupId: e.adGroupId, bizType: '1', productId: '101001005', token: globalData.subwayToken, targetings: '[' + JSON.stringify(r) + ']' }, success: function (e) { if ('200' == e.code) { var a = { code: 200, crowdId: e.result[0].id }; t(a) } else { t(a = { code: 400 }) } } }) } else if ('token' == e.type) try { globalData.token = e.token, localStorage.setItem('token', globalData.token); let s = { runAsShopName: globalData.subwayTokenData.runAsShopTitle, runAsShopId: globalData.subwayTokenData.runAsShopId, token: globalData.token }; console.log(s), webSocket.send(JSON.stringify(s)), t({ code: 200 }) } catch (e) { t({ code: 400 }) } else if ('getShopId' == e.type) { if (globalData.subwayTokenData.runAsShopId) o = { code: 200, currentShopid: globalData.subwayTokenData.runAsShopId }; else o = { code: 400 }; t(o) } else if ('version' == e.type) { console.log('version'); o = { code: 200, version: chrome.runtime.getManifest().version }; t(o) } else if ('logout' == e.type) $.ajax({ url: 'https://login.taobao.com/member/logout.jhtml', type: 'get', async: !0, success: function (e) { t({ code: 200 }) }, error: function () { t({ code: 400 }) } }); else { t(o = { code: 400 }) } let n; return !0 }), window.localStorage && (globalData.token = localStorage.getItem('token'), console.log(globalData.token))
'use strict'; function sendShopInfoToFrontend() { getVersion(), getShop().then((e) => { backRun(), globalData.subwayTokenData.runAsShopId != null && globalData.subwayTokenData.runAsShopId != e.data.runAsShopId && window.location.reload() }) } function main() { sendShopInfoToFrontend(), setInterval(() => { sendShopInfoToFrontend() }, 5e3) } main(); let isMsg = !0; function getVersion() {
  let s = new $.Deferred(); return $.ajax({
    url: `https://www.edoushu.com/data/ver.php?date=${  (new Date()).getTime()}`,
type: 'get',
async: !0,
success: function (e) {
      let n = e.split('|'),
        t = n[0].split('.'); t = 1e4 * t[0] + 100 * t[1] + 1 * t[2]; let o = chrome.runtime.getManifest().version.toString().split('.'); t <= (o = 1e4 * o[0] + 100 * o[1] + 1 * o[2]) ? s.resolve() : (isMsg && (isMsg = !1, chrome.notifications.create(null, { type: 'basic', iconUrl: 'images/logo48x48.png', title: '通知', message: n[2] })), n[1] == '0' ? s.resolve() : s.reject())
    }
  }), s.promise()
}
